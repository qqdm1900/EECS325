<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="lw.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 set-up-profiler
</TITLE>

<LINK REL="next" HREF="lw-841.htm" TYPE="text/html">
<LINK REL="prev" HREF="lw-839.htm" TYPE="text/html">
<LINK REL="up" HREF="lw-744.htm" TYPE="text/html">
<LINK REL="top" HREF="lw.htm" TYPE="text/html">
<LINK REL="contents" HREF="lw-2.htm" TYPE="text/html">
<LINK REL="index" HREF="lw-1525.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="lw.htm">LispWorks User Guide and Reference Manual</A> &gt; <A HREF="lw-744.htm">32 The HCL Package</A><BR><BR>
</DIV><A HREF="lw-841.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="lw-839.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="lw-744.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="lw.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="lw-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="lw-1525.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-890261"></A><A NAME="73344"></A>set<A NAME="marker-1043325"></A>-up-profiler</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-890262"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890263"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-890264"></A>Declares the parameter values of the profiling function.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890265"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-890266"></A>hcl</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890267"></A>Signature </H5>
<P CLASS="RSignature">
<A NAME="pgfId-1018467"></A>set-up-profiler &amp;key <EM CLASS="Variable">
symbols</EM>
 <EM CLASS="Variable">
packages</EM>
 <EM CLASS="Variable">
kind</EM>
 <EM CLASS="Variable">
interval</EM>
 <EM CLASS="Variable">
limit</EM>
 <EM CLASS="Variable">
cutoff</EM>
 <EM CLASS="Variable">
collapse</EM>
 <EM CLASS="Variable">
style</EM>
 <EM CLASS="Variable">
gc</EM>
 <EM CLASS="Variable">
call-counter</EM>
 <EM CLASS="Variable">
show-unknown-frames</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1018469"></A>Arguments </H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-890270"></A><EM CLASS="Variable">
symbols</EM>
</P>
<P CLASS="RDescription-C">A symbol or a list of symbols.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-890271"></A><EM CLASS="Variable">
packages</EM>
</P>
<P CLASS="RDescription-C">A valid package name, or a list of package names, or <CODE CLASS="Code">
:all</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1032586"></A><EM CLASS="Variable">
kind</EM>
</P>
<P CLASS="RDescription-C"><CODE CLASS="Code">
:profile</CODE>
, <CODE CLASS="Code">
:virtual</CODE>
 or <CODE CLASS="Code">
:real</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1226222"></A><EM CLASS="Variable">
interval</EM>
</P>
<P CLASS="RDescription-C">An integer greater than or equal to 10000.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1226223"></A><EM CLASS="Variable">
limit</EM>
</P>
<P CLASS="RDescription-C">An integer or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1230845"></A><EM CLASS="Variable">
cutoff</EM>
</P>
<P CLASS="RDescription-C">An integer or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1226225"></A><EM CLASS="Variable">
collapse</EM>
</P>
<P CLASS="RDescription-C">A generalized boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1228047"></A><EM CLASS="Variable">
style</EM>
</P>
<P CLASS="RDescription-C"><CODE CLASS="Code">
:tree</CODE>
, <CODE CLASS="Code">
:list</CODE>
 or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1233900"></A><EM CLASS="Variable">
gc</EM>
</P>
<P CLASS="RDescription-C">A generalized boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1234951"></A><EM CLASS="Variable">
call-counter</EM>
</P>
<P CLASS="RDescription-C">A generalized boolean.</P>
<P CLASS="RDescription">
<A NAME="pgfId-1234953"></A><EM CLASS="Variable">
show-unknown-frames</EM>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-1235874"></A>A generalized boolean.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890278"></A>Values</H5>
<P CLASS="RBody">
<A NAME="pgfId-890279"></A>The time interval is returned.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890280"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-890281"></A><CODE CLASS="Code">
set-up-profiler</CODE>
 is used to declare the values of the parameters of the profiling function. Three values are required, as follows.</P>
<P CLASS="RBody">
<A NAME="pgfId-890282"></A><EM CLASS="Variable">
symbols</EM>
, if non-nil, specifies which symbols are to be monitored by the profiler.  Each symbol in <EM CLASS="Variable">
symbols</EM>
 is checked to see if it is suitable for profiling and if so it is added to the list <A HREF="lw-818.htm#18560" CLASS="XRef">*profile-symbol-list*</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-1229325"></A>If <EM CLASS="Variable">
symbols</EM>
 is not passed then <EM CLASS="Variable">
packages</EM>
 specifies which symbols are to be monitored. If <EM CLASS="Variable">
packages</EM>
 is <CODE CLASS="Code">
:all</CODE>
, then all packages are monitored. All the symbols in the packages are checked as above. If a <EM CLASS="Variable">
symbols</EM>
 argument is present then <EM CLASS="Variable">
packages</EM>
 is ignored.</P>
<P CLASS="RBody">
<A NAME="pgfId-1032595"></A><EM CLASS="Variable">
kind</EM>
 specifies the way that the time between samples is measured on Unix-like platforms:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1177341"></A><CODE CLASS="Code">
:profile</CODE>
</P>
<P CLASS="RDescription-C">Process time only.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1178639"></A><CODE CLASS="Code">
:virtual</P>
<P CLASS="RDescription-C"></CODE>
Process time and system time for the process.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1178640"></A><CODE CLASS="Code">
:real</CODE>
</P>
<P CLASS="RDescription-C">Real time.</P>
<P CLASS="RBody">
<A NAME="pgfId-1268714"></A>The default value of <EM CLASS="Variable">
kind</EM>
 is <CODE CLASS="Code">
:profile</CODE>
. </P>
<P CLASS="RBody">
<A NAME="pgfId-1268721"></A><B CLASS="Bold">
Note:</B>
 <EM CLASS="Variable">
kind</EM>
 is ignored on Microsoft Windows platforms.</P>
<P CLASS="RBody">
<A NAME="pgfId-1229652"></A><EM CLASS="Variable">
interval</EM>
 specifies the interval in microseconds between profile samples. The minimum value of <EM CLASS="Variable">
interval</EM>
 is 10000, that is 10 ms. The default value of <EM CLASS="Variable">
interval</EM>
 is 10000.</P>
<P CLASS="RBody">
<A NAME="pgfId-1230613"></A><EM CLASS="Variable">
limit</EM>
, when non-nil, sets <A HREF="lw-776.htm#68580" CLASS="XRef">*default-profiler-limit*</A>. This limits the maximum number of lines printed in the profile output (not including the tree). The default value is 100.</P>
<P CLASS="RBody">
<A NAME="pgfId-1231596"></A><EM CLASS="Variable">
cutoff</EM>
, when non-nil, sets <A HREF="lw-775.htm#55188" CLASS="XRef">*default-profiler-cutoff*</A>. This is the default minimum percentage that the profiler will display in the output tree. Functions below this percentage will not be displayed. The default is <CODE CLASS="Code">
nil</CODE>
, that is there is no cutoff.</P>
<P CLASS="RBody">
<A NAME="pgfId-1232571"></A><EM CLASS="Variable">
collapse</EM>
 specifies whether functions with only one callee in the profile tree should be collapsed, that is, only the child is printed. When passed, sets <A HREF="lw-774.htm#64371" CLASS="XRef">*default-profiler-collapse*</A>. The default value of <EM CLASS="Variable">
collapse</EM>
 is <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1233656"></A><EM CLASS="Variable">
style</EM>
 controls the format of output. If <EM CLASS="Variable">
style</EM>
 is not passed or passed as <CODE CLASS="Code">
nil</CODE>
, the format does not change. If <EM CLASS="Variable">
style</EM>
 is passed, it can take these values:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1255686"></A><CODE CLASS="Code">
:list</CODE>
</P>
<P CLASS="RDescription-C">The profiler will show the functions seen on the stack.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1254703"></A><CODE CLASS="Code">
:tree</CODE>
</P>
<P CLASS="RDescription-C">The profiler will generate a tree of calls seen in the profiler, as well as the output shown by <CODE CLASS="Code">
:list</CODE>
.</P>
<P CLASS="RDescription">
<A NAME="pgfId-1254757"></A>The default value of <EM CLASS="Variable">
style</EM>
 is <CODE CLASS="Code">
:tree</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1234745"></A><EM CLASS="Variable">
gc</EM>
 specifies whether to profile functions inside the memory management code (more accurately, functions that are called on the GC stack) in addition to any other profiling. The default value of gc is <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1660669"></A><EM CLASS="Variable">
show-unknown-frames</EM>
 controls whether the profile tree shows nodes where the name of the function is unknown. The default value of <EM CLASS="Variable">
show-unknown-frames</EM>
 is <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1235225"></A><EM CLASS="Variable">
call-counter</EM>
 specifies whether to add extra code to count calls. The counting is done dynamically. If <EM CLASS="Variable">
call-counter</EM>
 is <CODE CLASS="Code">
nil</CODE>
, call counters are not added, and the call counter of all functions is displayed as 0. The default value of <EM CLASS="Variable">
call-counter</EM>
 is <CODE CLASS="Code">
nil</CODE>
 on Intel-based platforms and <CODE CLASS="Code">
t</CODE>
 on other platforms. This is because the counting significantly affects the performance of applications using Symmetric Multiprocessing (SMP).</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1235227"></A>Notes</H5>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-1660467"></A>Call counting can affect performance significantly on some platforms. To get accurate timing (in scales of a few percentage points), pass <EM CLASS="Variable">
call-counter</EM>
 <CODE CLASS="Code">
nil</CODE>
. However, in most cases the profiler is used to find bottlenecks where the slowdown is hundreds of percentage points and so the effect of call counting is less significant.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-1235071"></A><EM CLASS="Variable">
call-counter</EM>
 is effective only on x86 platforms or in 64-bit LispWorks. On non-x86 platforms 32-bit LispWorks does call counting for a given function if the compiler optimize quality <CODE CLASS="Code">
debug</CODE>
 is greater than 0 at compile-time, and <EM CLASS="Variable">
call-counter</EM>
 has no effect.</LI>
</OL>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890288"></A>Example</H5>
<PRE CLASS="RCode-first"><A NAME="pgfId-890623"></A>(set-up-profiler :symbols '(car cdr)</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-890624"></A>                 :interval 50000)</PRE>
<P CLASS="RBody">
<A NAME="pgfId-1032608"></A>On Unix/Linux/Mac OS X:</P>
<PRE CLASS="RCode-first"><A NAME="pgfId-1032924"></A>(set-up-profiler :symbols '(car cdr)</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-1032609"></A>                 :kind :profile :interval 50000)</PRE>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-890291"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-890295"></A><A HREF="lw-746.htm#28763" CLASS="XRef">add-symbol-profiler</A><BR>
<A HREF="lw-774.htm#64371" CLASS="XRef">*default-profiler-collapse*</A><BR>
<A HREF="lw-775.htm#55188" CLASS="XRef">*default-profiler-cutoff*</A><BR>
<A HREF="lw-776.htm#68580" CLASS="XRef">*default-profiler-limit*</A><BR>
<A HREF="lw-816.htm#18999" CLASS="XRef">profile</A><BR>
<A HREF="lw-818.htm#18560" CLASS="XRef">*profile-symbol-list*</A><BR>
<A HREF="lw-823.htm#61517" CLASS="XRef">remove-symbol-profiler</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">LispWorks User Guide and Reference Manual - 21 Dec 2011</I></P>
<P><A HREF="lw-841.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="lw-839.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="lw-744.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="lw.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="lw-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="lw-1525.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
