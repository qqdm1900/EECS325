<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="lw.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 set-blocking-gen-num
</TITLE>

<LINK REL="next" HREF="lw-1424.htm" TYPE="text/html">
<LINK REL="prev" HREF="lw-1422.htm" TYPE="text/html">
<LINK REL="up" HREF="lw-1330.htm" TYPE="text/html">
<LINK REL="top" HREF="lw.htm" TYPE="text/html">
<LINK REL="contents" HREF="lw-2.htm" TYPE="text/html">
<LINK REL="index" HREF="lw-1525.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="lw.htm">LispWorks User Guide and Reference Manual</A> &gt; <A HREF="lw-1330.htm">40 The SYSTEM Package</A><BR><BR>
</DIV><A HREF="lw-1424.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="lw-1422.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="lw-1330.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="lw.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="lw-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="lw-1525.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-1167168"></A><A NAME="33314"></A>set<A NAME="marker-1167167"></A>-blocking-gen-num</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-1167169"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167170"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-1167171"></A>Sets the blocking generation in 64-bit LispWorks.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167172"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-1167173"></A>system</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167174"></A>Signature</H5>
<P CLASS="RSignature">
<A NAME="pgfId-1167175"></A>set-blocking-gen-num <EM CLASS="Variable">
gen-num</EM>
 &amp;key <EM CLASS="Variable">
do-gc</EM>
 <EM CLASS="Variable">
max-size</EM>
 <EM CLASS="Variable">
max-size-to-copy</EM>
 <EM CLASS="Variable">
gc-threshold</EM>
 =&gt; <EM CLASS="Variable">
old-blocking-gen-num</EM>
, <EM CLASS="Variable">
do-gc</EM>
, <EM CLASS="Variable">
max-size-to-copy</EM>
, <EM CLASS="Variable">
old-gc-threshold</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167176"></A>Arguments</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1167177"></A><EM CLASS="Variable">
gen-num</EM>
</P>
<P CLASS="RDescription-C">An integer between 0 and 7, inclusive.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1167700"></A><EM CLASS="Variable">
do-gc</EM>
</P>
<P CLASS="RDescription-C">One of <CODE CLASS="Code">
t</CODE>
, <CODE CLASS="Code">
nil</CODE>
 and <CODE CLASS="Code">
:mark</CODE>
, or a real number between 0 and 10, inclusive.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1348844"></A><EM CLASS="Variable">
max-size-to-copy</EM>
</P>
<P CLASS="RDescription-C">A positive real number, or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1167744"></A><EM CLASS="Variable">
max-size</EM>
</P>
<P CLASS="RDescription-C">A synonym for <EM CLASS="Variable">
max-size-to-copy</EM>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1180178"></A><EM CLASS="Variable">
gc-threshold</EM>
</P>
<P CLASS="RDescription-C">An integer greater than 12800, or a real in the inclusive range [0 100], or <CODE CLASS="Code">
nil</CODE>
.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167178"></A>Values</H5>
<P CLASS="RDescription">
<A NAME="pgfId-1167179"></A><EM CLASS="Variable">
old-blocking-gen-num</EM>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-1169474"></A>An integer between 0 and 7, inclusive.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1180196"></A><EM CLASS="Variable">
do-gc</EM>
</P>
<P CLASS="RDescription-C">One of <CODE CLASS="Code">
t</CODE>
, <CODE CLASS="Code">
nil</CODE>
 and <CODE CLASS="Code">
:mark</CODE>
, or a real number between 0 and 10, inclusive.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1180277"></A><EM CLASS="Variable">
max-size-to-copy</EM>
</P>
<P CLASS="RDescription-C">A positive real number.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1169478"></A><EM CLASS="Variable">
old-gc-threshold</EM>
</P>
<P CLASS="RDescription-C">A number.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167180"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-1168313"></A>The function <CODE CLASS="Code">
set-blocking-gen-num</CODE>
 sets <EM CLASS="Variable">
gen-num</EM>
 as the generation that blocks. That is, no object is automatically promoted out of generation <EM CLASS="Variable">
gen-num</EM>
 to a higher generation.</P>
<P CLASS="RBody">
<A NAME="pgfId-1168314"></A>If <EM CLASS="Variable">
do-gc</EM>
 is non-nil, then generation <EM CLASS="Variable">
gen-num</EM>
 is automatically collected when needed, as defined by <EM CLASS="Variable">
gc-threshold</EM>
 (see <A HREF="lw-1427.htm#95845" CLASS="XRef">set-gen-num-gc-threshold</A>).</P>
<P CLASS="RBody">
<A NAME="pgfId-1168108"></A>The actual value of <EM CLASS="Variable">
do-gc</EM>
 specifies how to GC the blocking generation when required. The possible values of <EM CLASS="Variable">
do-gc</EM>
 are interpreted as follows:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1168109"></A><CODE CLASS="Code">
t</CODE>
</P>
<P CLASS="RDescription-C">Use Copying GC.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1168110"></A><CODE CLASS="Code">
:mark</CODE>
</P>
<P CLASS="RDescription-C">Use Marking GC.</P>
<P CLASS="RDescription">
<A NAME="pgfId-1168111"></A>A number in the inclusive range [0, 10]</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-1169817"></A>Use Marking GC with copying of fragmented segments. The value specifies the <EM CLASS="Variable">
fragmentation-threshold</EM>
 (the same as the argument to <A HREF="lw-1407.htm#28021" CLASS="XRef">marking-gc</A>). This is the ratio between the amount of free space that cannot be easily used and the amount of allocated space inside a segment. Only segments with fragmentation higher than the threshold are copied.</P>
<P CLASS="RBody">
<A NAME="pgfId-1169463"></A>The default value of <EM CLASS="Variable">
do-gc</EM>
 is <CODE CLASS="Code">
t</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1168112"></A><EM CLASS="Variable">
max-size-to-copy</EM>
 is meaningful only if <EM CLASS="Variable">
do-gc</EM>
 is a number. It specifies the maximum size in Gigabytes to try to copy. If the fragmented segments contain more data than this value, only some of them are copied in each GC.</P>
<P CLASS="RBody">
<A NAME="pgfId-1168113"></A>If <EM CLASS="Variable">
gc-threshold</EM>
 is non-nil, it is used to set the threshold for automatic GC using <A HREF="lw-1427.htm#95845" CLASS="XRef">set-gen-num-gc-threshold</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-1168114"></A>The initial setup is as if this call has been made:</P>
<CODE CLASS="RCode-line">
<A NAME="pgfId-1168115"></A>         (sys:set-blocking-gen-num 3)</CODE>
<P CLASS="RBody">
<A NAME="pgfId-1168116"></A>That is, the system will GC automatically according to the default <EM CLASS="Variable">
gc-threshold</EM>
 using Copying GC.</P>
<P CLASS="RBody">
<A NAME="pgfId-1168117"></A>Setting the blocking generation <EM CLASS="Variable">
gen-num</EM>
 to a lower number is useful into two situations:</P>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-1168118"></A>When you have an operation that allocates a significant amount of data, and almost of it goes when the operation finishes, it is useful to reduce the blocking <EM CLASS="Variable">
gen-num</EM>
 during the operation. The macro <A HREF="lw-755.htm#block-promotion" CLASS="XRef">block-promotion</A> is a convenient way of doing that.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-1168119"></A>If you have a good idea of how your application behaves, it may be useful to block at a lower generation (2 or 1), and then periodically call <A HREF="lw-797.htm#55872" CLASS="XRef">gc-generation</A> explicitly to promote long living objects to a higher generation. The advantage of doing this is that you can call <A HREF="lw-797.htm#55872" CLASS="XRef">gc-generation</A> in places where you know there are not many short-lived objects alive.</LI>
</OL>
<P CLASS="RBody">
<A NAME="pgfId-1168120"></A>Passing a <EM CLASS="Variable">
do-gc</EM>
 value other than <CODE CLASS="Code">
t</CODE>
 is useful when the blocking generation can be large enough that copying it all may cause very serious paging. Passing <EM CLASS="Variable">
do-gc</EM>
 <CODE CLASS="Code">
:mark</CODE>
 will stop the system from copying the blocking generation, but may cause fragmentation if a significant number of long-lived objects die after a while, and there are not explicit calls to <A HREF="lw-797.htm#55872" CLASS="XRef">gc-generation</A> or <A HREF="lw-1407.htm#28021" CLASS="XRef">marking-gc</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-1167181"></A><CODE CLASS="Code">
set-blocking-gen-num</CODE>
 returns four values: the old blocking generation number, the old value of <EM CLASS="Variable">
do-gc</EM>
, the <EM CLASS="Variable">
max-size-to-copy</EM>
, and the old value of <EM CLASS="Variable">
gc-threshold</EM>
. It can be called with <EM CLASS="Variable">
gen-num</EM>
 <CODE CLASS="Code">
nil</CODE>
 to query the values without changing any of them.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167779"></A>Notes</H5>
<P CLASS="RBody">
<A NAME="pgfId-1656585"></A><CODE CLASS="Code">
set-blocking-gen-num</CODE>
 is implemented only in 64-bit LispWorks. It is not relevant to the Memory Management API in 32-bit implementations.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1167194"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-1167198"></A><A HREF="lw-755.htm#block-promotion" CLASS="XRef">block-promotion</A><BR>
<A HREF="lw-797.htm#55872" CLASS="XRef">gc-generation</A><BR>
<A HREF="lw-1407.htm#28021" CLASS="XRef">marking-gc</A><BR>
<A HREF="lw-1422.htm#14543" CLASS="XRef">set-automatic-gc-callback</A><BR>
<A HREF="lw-1427.htm#95845" CLASS="XRef">set-gen-num-gc-threshold</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">LispWorks User Guide and Reference Manual - 21 Dec 2011</I></P>
<P><A HREF="lw-1424.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="lw-1422.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="lw-1330.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="lw.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="lw-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="lw-1525.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
