<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="lw.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 open-named-pipe-stream
</TITLE>

<LINK REL="next" HREF="lw-1462.htm" TYPE="text/html">
<LINK REL="prev" HREF="lw-1460.htm" TYPE="text/html">
<LINK REL="up" HREF="lw-1450.htm" TYPE="text/html">
<LINK REL="top" HREF="lw.htm" TYPE="text/html">
<LINK REL="contents" HREF="lw-2.htm" TYPE="text/html">
<LINK REL="index" HREF="lw-1525.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="lw.htm">LispWorks User Guide and Reference Manual</A> &gt; <A HREF="lw-1450.htm">41 Miscellaneous WIN32 symbols</A><BR><BR>
</DIV><A HREF="lw-1462.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="lw-1460.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="lw-1450.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="lw.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="lw-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="lw-1525.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-1054425"></A><A NAME="10506"></A>o<A NAME="marker-1054423"></A>pen-named-pipe<A NAME="marker-1054424"></A>-stream</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-1054426"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1054427"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-1054428"></A>Creates a stream that writes and read through a named pipe.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1059487"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-1059488"></A>win32</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1054429"></A>Signature</H5>
<P CLASS="RSignature">
<A NAME="pgfId-1054430"></A>open-named-pipe-stream <EM CLASS="Variable">
name</EM>
 &amp;key <EM CLASS="Variable">
errorp</EM>
 <EM CLASS="Variable">
allow-remote</EM>
 <EM CLASS="Variable">
max-number</EM>
 <EM CLASS="Variable">
wait-reason</EM>
 <EM CLASS="Variable">
timeout</EM>
 <EM CLASS="Variable">
wait-function</EM>
 <EM CLASS="Variable">
direction</EM>
 <EM CLASS="Variable">
inherit-access-p</EM>
 <EM CLASS="Variable">
access</EM>
 =&gt; <EM CLASS="Variable">
stream</EM>
, <EM CLASS="Variable">
connectedp</EM>
, <EM CLASS="Variable">
condition</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1054431"></A>Arguments</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054432"></A><EM CLASS="Variable">
name</EM>
</P>
<P CLASS="RDescription-C">A string identifying the pipe.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054433"></A><EM CLASS="Variable">
errorp</EM>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054434"></A><EM CLASS="Variable">
allow-remote</EM>
</P>
<P CLASS="RDescription-C">A boolean. </P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054435"></A><EM CLASS="Variable">
max-number</EM>
</P>
<P CLASS="RDescription-C">An integer in the inclusive range [1,254] or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054436"></A><EM CLASS="Variable">
wait-reason</EM>
</P>
<P CLASS="RDescription-C">A string or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054437"></A><EM CLASS="Variable">
timeout</EM>
</P>
<P CLASS="RDescription-C">A real number or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054438"></A><EM CLASS="Variable">
wait-function</EM>
</P>
<P CLASS="RDescription-C">A function of no arguments, or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054439"></A><EM CLASS="Variable">
direction</EM>
</P>
<P CLASS="RDescription-C">One of <CODE CLASS="Code">
:io</CODE>
, <CODE CLASS="Code">
:input</CODE>
, <CODE CLASS="Code">
:output</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054440"></A><EM CLASS="Variable">
inherit-access-p</EM>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054441"></A><EM CLASS="Variable">
access</EM>
</P>
<P CLASS="RDescription-C">A list, keyword, integer or string.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1054442"></A>Values</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054443"></A><EM CLASS="Variable">
stream</EM>
</P>
<P CLASS="RDescription-C">A stream or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054444"></A><EM CLASS="Variable">
connectedp</EM>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1054445"></A><EM CLASS="Variable">
condition</EM>
</P>
<P CLASS="RDescription-C">An error condition or <CODE CLASS="Code">
nil</CODE>
.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1054446"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-1054447"></A>The function <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 creates a stream that communicates via a named pipe, and then tries to establish a connection. For a connection to be established, another process (which can be a Lisp process in the same image, or another process altogether) must connect to it. In LispWorks this is done by <A HREF="lw-1452.htm#24757" CLASS="XRef">connect-to-named-pipe</A>, other software does by the underlying Windows function <CODE CLASS="Code">
ConnectNamedPipe</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054451"></A><CODE CLASS="Code">
open-named-pipe-stream</CODE>
 returns three values. <EM CLASS="Variable">
stream</EM>
 is a stream on success, and <CODE CLASS="Code">
nil</CODE>
 if there is an error and <EM CLASS="Variable">
errorp</EM>
 is <CODE CLASS="Code">
nil</CODE>
. If <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 returns a stream and <EM CLASS="Variable">
connectedp</EM>
 is non-nil, the stream is connected and is ready for input/output operations like a normal stream. <EM CLASS="Variable">
condition</EM>
 is an error condition if an error occurred and <EM CLASS="Variable">
errorp</EM>
 is <CODE CLASS="Code">
nil</CODE>
, otherwise it is <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054452"></A>When <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 returns a stream and <EM CLASS="Variable">
connectedp</EM>
 is <CODE CLASS="Code">
nil</CODE>
 (which can happen when <EM CLASS="Variable">
timeout</EM>
 is non-nil or <EM CLASS="Variable">
wait-function</EM>
 returns <CODE CLASS="Code">
t</CODE>
), the stream is valid but is not ready for I/O and gives an error for any reading or writing calls. In this case the function <A HREF="lw-1470.htm#91769" CLASS="XRef">wait-for-connection</A> must be used to establish the connection, and once it returns non-nil the stream is ready for input/output operations.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054456"></A>Note that that if you stop using a stream before it is connected, it still must be closed (by <CODE CLASS="Code">
cl:close</CODE>
) to get rid of the named pipe.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054457"></A>The creation has two steps:</P>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-1054458"></A>Creating the named pipe. This is controlled by <EM CLASS="Variable">
name</EM>
, <EM CLASS="Variable">
max-number</EM>
, <EM CLASS="Variable">
direction</EM>
, <EM CLASS="Variable">
access</EM>
, <EM CLASS="Variable">
inherit-access-p</EM>
, <EM CLASS="Variable">
allow-remote</EM>
 and <EM CLASS="Variable">
errorp</EM>
.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-1054459"></A>Waiting for connection. This is controlled by <EM CLASS="Variable">
timeout</EM>
, <EM CLASS="Variable">
wait-reason</EM>
, and <EM CLASS="Variable">
wait-function</EM>
.</LI>
</OL>
<P CLASS="RBody">
<A NAME="pgfId-1054460"></A><EM CLASS="Variable">
name</EM>
 is the pipe name. It can contain any character except <CODE CLASS="Code">
#&#92;&#92;</CODE>
 (according to the MSDN). <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 prepends to it the pipe prefix <CODE CLASS="Code">
&#92;&#92;.&#92;pipe&#92;</CODE>
. It needs to be highly unique, because on the same machine it is visible to all processes.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054461"></A><EM CLASS="Variable">
direction</EM>
 specifies the direction of I/O with the conventional  meaning (as in Common Lisp file streams). The default value of <EM CLASS="Variable">
direction</EM>
 is <CODE CLASS="Code">
:io</CODE>
. All simultanous opened pipes with the same name on the same machine must be opened with the same value of <EM CLASS="Variable">
direction</EM>
. If different <EM CLASS="Variable">
direction</EM>
 values are used, it causes <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 to give an error. </P>
<P CLASS="RBody">
<A NAME="pgfId-1054462"></A><EM CLASS="Variable">
max-number</EM>
 specifies the maximum number of simultanously existing pipes with the same name on the local machine. By default it is unlimited. All simultanous pipes with the same name on the same machine must have the same <EM CLASS="Variable">
max-number</EM>
, though currently this is not enforced.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054463"></A><EM CLASS="Variable">
access</EM>
 specifies access permission, which controls who can connect to the pipe. If it is <CODE CLASS="Code">
nil</CODE>
, the permissions of the current thread are inherited and used (<EM CLASS="Variable">
inherit-access-p</EM>
 is ignored in this case), and if <EM CLASS="Variable">
access</EM>
 is <CODE CLASS="Code">
:world</CODE>
 the pipe is created with no restrictions. Otherwise <EM CLASS="Variable">
access</EM>
 has to be a keyword, a list, an integer or a string, and it is passed to <A HREF="lw-1462.htm#94652" CLASS="XRef">security-description-string-for-open-named-pipe</A>. See the entry for <A HREF="lw-1462.htm#94652" CLASS="XRef">security-description-string-for-open-named-pipe</A> for details. The result of <A HREF="lw-1462.htm#94652" CLASS="XRef">security-description-string-for-open-named-pipe</A>, potentially with the inherited access appended, is passed to the Windows function <CODE CLASS="Code">
ConvertStringSecurityDescriptorToSecurityDescriptor</CODE>
 to generate the descriptor that is used when creating the pipe.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054473"></A><EM CLASS="Variable">
inherit-access-p</EM>
 controls whether the permissions of the current thread are inherited when <EM CLASS="Variable">
access</EM>
 is not <CODE CLASS="Code">
nil</CODE>
 or <CODE CLASS="Code">
:world</CODE>
 or a string. When it is not <CODE CLASS="Code">
nil</CODE>
, the permissions of the current thread are appended to what is specified by <EM CLASS="Variable">
access</EM>
 (which means that the specification in <EM CLASS="Variable">
access</EM>
 takes precedence). The default value of <EM CLASS="Variable">
inherit-access-p</EM>
 is <CODE CLASS="Code">
t</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054474"></A><EM CLASS="Variable">
allow-remote</EM>
 controls whether the pipe can be connected from another machine. The default value of <EM CLASS="Variable">
allow-remote</EM>
 is <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054475"></A><EM CLASS="Variable">
errorp</EM>
 controls what happens when there is a failure because of one of these possibilities:</P>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-1054478"></A><A HREF="lw-1462.htm#94652" CLASS="XRef">security-description-string-for-open-named-pipe</A> returns <CODE CLASS="Code">
nil</CODE>
 because <EM CLASS="Variable">
access</EM>
 contains unknown entities (for example a user name that does not exist on the local machine)</LI>
<LI CLASS="RStep">
<A NAME="pgfId-1054482"></A>Converting the string that <A HREF="lw-1462.htm#94652" CLASS="XRef">security-description-string-for-open-named-pipe</A> returned to a security descriptor failed. That can happen if <EM CLASS="Variable">
access</EM>
 is a string in bad format or a list containing strings in bad format.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-1054484"></A><CODE CLASS="Code">
open-named-pipe-stream</CODE>
 failed for some other reason, for example it reached the limit on the number of the pipes with this name, or tried to open it with a different <EM CLASS="Variable">
direction</EM>
 from the previous call.</LI>
</OL>
<P CLASS="RBody">
<A NAME="pgfId-1054485"></A>When there has been a failure, if <EM CLASS="Variable">
errorp</EM>
 is non-nil an error is signalled, and if <EM CLASS="Variable">
errorp</EM>
 is <CODE CLASS="Code">
nil</CODE>
 then <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 returns <EM CLASS="Variable">
stream</EM>
 <CODE CLASS="Code">
nil</CODE>
 and <EM CLASS="Variable">
connectedp</EM>
 <CODE CLASS="Code">
nil</CODE>
 with the error condition returned as the third value <EM CLASS="Variable">
condition</EM>
. The default value of <EM CLASS="Variable">
errorp</EM>
 is <CODE CLASS="Code">
t</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054486"></A>Once the pipe has been successfully created, <CODE CLASS="Code">
open-named-pipe-stream</CODE>
 uses <A HREF="lw-1470.htm#91769" CLASS="XRef">wait-for-connection</A> to establish the connection, passing <EM CLASS="Variable">
timeout</EM>
, <EM CLASS="Variable">
wait-reason</EM>
 and <EM CLASS="Variable">
wait-function</EM>
, and returns the stream as first value, the result of <A HREF="lw-1470.htm#91769" CLASS="XRef">wait-for-connection</A> as the second value, and <CODE CLASS="Code">
nil</CODE>
 as the third value. See the description of <A HREF="lw-1470.htm#91769" CLASS="XRef">wait-for-connection</A> for details.</P>
<P CLASS="RBody">
<A NAME="pgfId-1054498"></A>To connect to the other side of the pipe from Lisp, use <A HREF="lw-1452.htm#24757" CLASS="XRef">connect-to-named-pipe</A>. The Microsoft Windows function is <CODE CLASS="Code">
ConnectNamedPipe</CODE>
. </P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1054500"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-1054504"></A><A HREF="lw-1470.htm#91769" CLASS="XRef">wait-for-connection</A><BR>
<A HREF="lw-1462.htm#94652" CLASS="XRef">security-description-string-for-open-named-pipe</A><BR>
<A HREF="lw-1460.htm#22136" CLASS="XRef">named-pipe-stream-name</A><BR>
<A HREF="lw-1452.htm#24757" CLASS="XRef">connect-to-named-pipe</A><BR>
<A HREF="lw-1454.htm#92905" CLASS="XRef">impersonating-named-pipe-client</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">LispWorks User Guide and Reference Manual - 21 Dec 2011</I></P>
<P><A HREF="lw-1462.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="lw-1460.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="lw-1450.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="lw.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="lw-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="lw-1525.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
