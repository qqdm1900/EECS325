<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 ole-control-pane
</TITLE>

<LINK REL="next" HREF="capiref-271.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-269.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-4.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-4.htm">1 CAPI Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-271.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-269.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-4462916"></A><A NAME="79990"></A>ole<A NAME="marker-4475868"></A>-control<A NAME="marker-6822009"></A>-pane</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-4462917"></A>Class</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4462918"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-4462922"></A>A class that implements embedding of external components on Microsoft Windows.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4462923"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-4462924"></A>capi</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4462925"></A>Superclasses</H5>
<P CLASS="RBody">
<A NAME="pgfId-4462929"></A><A HREF="capiref-293.htm#24209" CLASS="XRef">pinboard-layout</A></P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4462938"></A>Initargs</H5>
<P CLASS="RDescription">
<A NAME="pgfId-4462940"></A><CODE CLASS="Code">
:component-name</CODE>
<A NAME="marker-4462939"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-4475913"></A>A string or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription">
<A NAME="pgfId-4462942"></A><CODE CLASS="Code">
:user-component</CODE>
<A NAME="marker-4462941"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-4462943"></A>A COM interface pointer or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-4462945"></A><CODE CLASS="Code">
:save-name</CODE>
<A NAME="marker-4462944"></A></P>
<P CLASS="RDescription-C">A string.</P>
<P CLASS="RDescription">
<A NAME="pgfId-4475963"></A><CODE CLASS="Code">
:insert-callback</CODE>
<A NAME="marker-4475962"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-4475964"></A>A function.</P>
<P CLASS="RDescription">
<A NAME="pgfId-4475974"></A><CODE CLASS="Code">
:close-callback</CODE>
<A NAME="marker-4475973"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-4475975"></A>A function.</P>
<P CLASS="RDescription">
<A NAME="pgfId-5111504"></A><CODE CLASS="Code">
:sinks</CODE>
<A NAME="marker-5111503"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-5111505"></A>A list of sink specifications.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4462951"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-4476125"></A>The class <CODE CLASS="Code">
ole-control-pane</CODE>
 is used to implement embedding of external components. </P>
<P CLASS="RBody">
<A NAME="pgfId-4553150"></A><B CLASS="Bold">
Note:</B>
 <CODE CLASS="Code">
ole-control-pane</CODE>
 is implemented only in LispWorks for Windows. Load the functionality by <CODE CLASS="Code">
(require &quot;embed&quot;)</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-4501007"></A><B CLASS="Bold">
Note:</B>
 even though it is a subclass of <A HREF="capiref-293.htm#24209" CLASS="XRef">pinboard-layout</A>, normally you should not use the <A HREF="capiref-293.htm#24209" CLASS="XRef">pinboard-layout</A> functionality when using <CODE CLASS="Code">
ole-control-pane</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-4476127"></A><EM CLASS="Variable">
component-name</EM>
 (if non-nil) specifies the <EM CLASS="Variable">
component-name</EM>
 of the pane, as used by <A HREF="capiref-53.htm#76142" CLASS="XRef">component-name</A><CODE CLASS="Code">
.</CODE>
</P>
<P CLASS="RBody">
<A NAME="pgfId-4476129"></A><EM CLASS="Variable">
user-component</EM>
 (if non-nil) is a COM interface pointer of an object that supports the <CODE CLASS="Code">
I-OLE-OBJECT</CODE>
 interface, and is ready to display as described in <A HREF="capiref-273.htm#94608" CLASS="XRef">ole-control-user-component</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-4476131"></A><EM CLASS="Variable">
save-name</EM>
 is used when creating the <CODE CLASS="Code">
IStorage</CODE>
 object for this component.</P>
<P CLASS="RBody">
<A NAME="pgfId-4476133"></A><EM CLASS="Variable">
insert-callback</EM>
 (if non-nil) is a function that takes a single argument, the pane. It is called immediately after a component was inserted into the pane. This can be used for any additional initialization that is required, for example setting the properties of the control.</P>
<P CLASS="RBody">
<A NAME="pgfId-4476135"></A><EM CLASS="Variable">
close-callback</EM>
 (if non-nil) is a function that takes a single argument, the pane. It is called just before the component is going to be closed, and can be used to do any cleanups that may be required.</P>
<P CLASS="RBody">
<A NAME="pgfId-5111510"></A><EM CLASS="Variable">
sinks</EM>
 is a list of sink specifications for attaching event handlers to the source interfaces of the control. Each element of <EM CLASS="Variable">
sinks</EM>
 should be a list of the form:</P>
<CODE CLASS="RCode-line">
<A NAME="pgfId-5217953"></A>(<EM CLASS="Variable">
interface-name</EM>
 &amp;key <EM CLASS="Variable">
invoke-callback</EM>
 <EM CLASS="Variable">
sink-class</EM>
 <EM CLASS="Variable">
sink</EM>
)</CODE>
<P CLASS="RBody">
<A NAME="pgfId-5218928"></A>The <EM CLASS="Variable">
interface-name</EM>
 is used to specify the name of the source interface in the control, which is either a string naming the interface or <CODE CLASS="Code">
:default</CODE>
 for the default source interface. If <EM CLASS="Variable">
invoke-callback</EM>
 is given, then it should be a function which will be called with the pane, method-name, method-kind and arguments vector for each source event. The <EM CLASS="Variable">
sink-class</EM>
 can be given to set the class of the internal object used for the sink interface. This is similar to calling <A HREF="capiref-16.htm#58689" CLASS="XRef">attach-simple-sink</A>. Alternatively, instead of calling <EM CLASS="Variable">
invoke-callback</EM>
, the <EM CLASS="Variable">
sink</EM>
 can be specified directly. This is similar to calling <A HREF="capiref-17.htm#67711" CLASS="XRef">attach-sink</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-5218932"></A>When the <CODE CLASS="Code">
ole-control-pane</CODE>
 is destroyed, the sinks are automatically detached.</P>
<P CLASS="RBody">
<A NAME="pgfId-5218933"></A>There are currently three ways to insert an external component into an <CODE CLASS="Code">
ole-control-pane</CODE>
. These are:</P>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-4476138"></A>Call <A HREF="capiref-273.htm#94608" CLASS="XRef">ole-control-user-component</A>, which asks the user for something to insert.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-4476139"></A>Set the <EM CLASS="Variable">
component-name</EM>
 of the pane. This can be done either via the initarg <CODE CLASS="Code">
:component-name</CODE>
 or by calling <CODE CLASS="Code">
(setf component-name)</CODE>
.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-4476140"></A>Set the <EM CLASS="Variable">
user-component</EM>
 of the pane, either via the initarg <CODE CLASS="Code">
:user-component</CODE>
 or by calling <CODE CLASS="Code">
(setf ole-control-user-component)</CODE>
.</LI>
</OL>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4462964"></A>Example</H5>
<PRE CLASS="RCode-first"><A NAME="pgfId-4504198"></A>(capi:contain </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-4504199"></A> (list </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-4504200"></A>  (make-instance 'capi:ole-control-pane</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-4504156"></A>                 :component-name &quot;OWC.Spreadsheet.9&quot;)))</PRE>
<P CLASS="RBody">
<A NAME="pgfId-4504158"></A>See <CODE CLASS="Code">
examples/com/ole/simple-container/sink.lisp</CODE>
 for a full example.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4504264"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-4504306"></A><A HREF="capiref-17.htm#67711" CLASS="XRef">attach-sink</A><BR>
<A HREF="capiref-53.htm#76142" CLASS="XRef">component-name</A><BR>
<A HREF="capiref-75.htm#82099" CLASS="XRef">detach-sink</A><BR>
<A HREF="capiref-195.htm#78390" CLASS="XRef">interface-menu-groups</A><BR>
<A HREF="capiref-262.htm#88445" CLASS="XRef">ole-control-add-verbs</A><BR>
<A HREF="capiref-263.htm#77838" CLASS="XRef">ole-control-close-object</A><BR>
<A HREF="capiref-267.htm#17645" CLASS="XRef">ole-control-i-dispatch</A><BR>
<A HREF="capiref-268.htm#37863" CLASS="XRef">ole-control-insert-object</A><BR>
<A HREF="capiref-269.htm#19275" CLASS="XRef">ole-control-ole-object</A><BR>
<A HREF="capiref-271.htm#12980" CLASS="XRef">ole-control-pane-frame</A><BR>
<A HREF="capiref-273.htm#94608" CLASS="XRef">ole-control-user-component</A><BR>
<A HREF="capiref-354.htm#19961" CLASS="XRef">report-active-component-failure</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-271.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-269.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
