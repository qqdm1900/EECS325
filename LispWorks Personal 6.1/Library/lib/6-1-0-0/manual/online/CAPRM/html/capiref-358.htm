<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 rich-text-pane-operation
</TITLE>

<LINK REL="next" HREF="capiref-359.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-357.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-4.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-4.htm">1 CAPI Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-359.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-357.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-3391639"></A><A NAME="54236"></A>rich<A NAME="marker-4220534"></A>-text-pane-operation</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-3391640"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3391641"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-3391642"></A>Gets and sets values and performs various operations on the pane.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4220026"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-4220525"></A>capi</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3391644"></A>Signature</H5>
<P CLASS="RSignature">
<A NAME="pgfId-3398794"></A><CODE CLASS="Code">
rich-text-pane-operation </CODE>
<EM CLASS="Variable">
pane</EM>
 <EM CLASS="Variable">
operation</EM>
 <CODE CLASS="Code">
&amp;rest </CODE>
<EM CLASS="Variable">
args</EM>
 =&gt; <EM CLASS="Variable">
result,</EM>
 <EM CLASS="Variable">
result2</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3398796"></A>Arguments</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3391650"></A><EM CLASS="Variable">
pane</EM>
</P>
<P CLASS="RDescription-C">A <A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A>.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3391651"></A><EM CLASS="Variable">
operation</EM>
</P>
<P CLASS="RDescription-C">A keyword specifying the operation to perform.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3396767"></A><EM CLASS="Variable">
args</EM>
</P>
<P CLASS="RDescription-C">The value or values to use, when the operation is setting something.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3391652"></A>Values</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3391653"></A><EM CLASS="Variable">
result</EM>
</P>
<P CLASS="RDescription-C">Various, see below.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3398886"></A><EM CLASS="Variable">
result2</EM>
</P>
<P CLASS="RDescription-C">Returned only for <EM CLASS="Variable">
operation</EM>
 <CODE CLASS="Code">
:get-selection</CODE>
, see below.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3391654"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-3397204"></A>The valid values of <EM CLASS="Variable">
operation</EM>
 on Microsoft Windows and Cocoa are:</P>
<P CLASS="RDescription">
<A NAME="pgfId-3397222"></A><CODE CLASS="Code">
:pastep</CODE>
, <CODE CLASS="Code">
:cutp</CODE>
 or <CODE CLASS="Code">
:copyp</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3397284"></A><EM CLASS="Variable">
result</EM>
 is a boolean indicating whether it is currently possible to perform a <CODE CLASS="Code">
:paste</CODE>
, <CODE CLASS="Code">
:cut</CODE>
 or <CODE CLASS="Code">
:copy</CODE>
 operation.</P>
<P CLASS="RDescription">
<A NAME="pgfId-3397264"></A><CODE CLASS="Code">
:paste</CODE>
, <CODE CLASS="Code">
:cut</CODE>
, or <CODE CLASS="Code">
:copy</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3397467"></A>Performs the indicated operation.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3397487"></A><CODE CLASS="Code">
:select-all</CODE>
</P>
<P CLASS="RDescription-C">Selects all the text.</P>
<P CLASS="RDescription">
<A NAME="pgfId-3397607"></A><CODE CLASS="Code">
:set-selection</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3398721"></A><EM CLASS="Variable">
args</EM>
 should be two integers <EM CLASS="Variable">
start</EM>
 and <EM CLASS="Variable">
end</EM>
. Sets the selection to the region bounded by <EM CLASS="Variable">
start</EM>
 (inclusive) and <EM CLASS="Variable">
end</EM>
 (exclusive).</P>
<P CLASS="RDescription">
<A NAME="pgfId-3398637"></A><CODE CLASS="Code">
:get-selection</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3398725"></A>Returns as multiple values the bounding indexes of the selection. <EM CLASS="Variable">
result</EM>
 is the start (inclusive) and <EM CLASS="Variable">
result2</EM>
 is the end (exclusive). If there is no selection, both values are the index of the insertion point.</P>
<P CLASS="RDescription">
<A NAME="pgfId-3433522"></A><CODE CLASS="Code">
:can-undo</CODE>
 or <CODE CLASS="Code">
:can-redo</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3433538"></A><EM CLASS="Variable">
result</EM>
 is a boolean indicating whether it is currently possible to perform an <CODE CLASS="Code">
:undo</CODE>
 or <CODE CLASS="Code">
:redo</CODE>
 operation.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3433551"></A><CODE CLASS="Code">
:undo</CODE>
</P>
<P CLASS="RDescription-C">Undoes the last editing operation. Note that, after typing, it is the whole input, rather than a single character, that is undone. The <CODE CLASS="Code">
:undo</CODE>
 operation may be repeated successively, to undo previous editing operations in turn.</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3436233"></A><B CLASS="Bold">
Note:</B>
 with RichEdit 1.0, <CODE CLASS="Code">
:undo</CODE>
 does not work repeatedly - it only undoes one previous editing operation. See <A HREF="capiref-360.htm#58824" CLASS="XRef">rich-text-version</A></P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3433614"></A><CODE CLASS="Code">
:redo</CODE>
</P>
<P CLASS="RDescription-C">Undoes the effect of the last <CODE CLASS="Code">
:undo</CODE>
 operation. The <CODE CLASS="Code">
:redo</CODE>
 operation may be repeated successively, to cancel the effect of previous <CODE CLASS="Code">
:undo</CODE>
 operations in turn.</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3436888"></A><B CLASS="Bold">
Note:</B>
 with RichEdit 1.0, <CODE CLASS="Code">
:redo</CODE>
 does not work. See <A HREF="capiref-360.htm#58824" CLASS="XRef">rich-text-version</A>.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3397652"></A><CODE CLASS="Code">
:get-modified</CODE>
</P>
<P CLASS="RDescription-C"><EM CLASS="Variable">
result</EM>
 is the value of a boolean modified flag. This flag can be set by the <CODE CLASS="Code">
:set-modified</CODE>
 operation. Also, editing the text sets it to true.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3400850"></A><CODE CLASS="Code">
:set-modified</CODE>
</P>
<P CLASS="RDescription-C">Sets the modified flag. The argument is a boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3401071"></A><CODE CLASS="Code">
:save-file</CODE>
</P>
<P CLASS="RDescription-C">Saves the text to a file. Details below.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3410392"></A><CODE CLASS="Code">
:load-file</CODE>
</P>
<P CLASS="RDescription-C">Loads the text from a file. Details below.</P>
<P CLASS="RBody">
<A NAME="pgfId-6543939"></A>Additionally these values of <EM CLASS="Variable">
operation</EM>
 are valid on Microsoft Windows, only:</P>
<P CLASS="RDescription">
<A NAME="pgfId-6552864"></A><CODE CLASS="Code">
:get-word-wrap</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-6552865"></A>Returns a value indicating the word wrap, which can be the keyword <CODE CLASS="Code">
:none</CODE>
. <EM CLASS="Variable">
result</EM>
 can also be the keyword <CODE CLASS="Code">
:window</CODE>
 or a CAPI printer object, meaning that the text wraps according to the width of the window or the printer.</P>
<P CLASS="RDescription">
<A NAME="pgfId-6552866"></A><CODE CLASS="Code">
:set-word-wrap</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-6552867"></A>Sets the word wrap. The argument can be as described for <CODE CLASS="Code">
:get-word-wrap</CODE>
, and additionally it can be the keyword <CODE CLASS="Code">
:printer</CODE>
, meaning the <A HREF="capiref-65.htm#29614" CLASS="XRef">current-printer</A>.</P>
<P CLASS="RDescription">
<A NAME="pgfId-6551565"></A><CODE CLASS="Code">
:hide-selection</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-6551566"></A>Specifies whether the selection should be hidden (not highlighted) when <EM CLASS="Variable">
pane</EM>
 does not have the focus. The argument is a boolean. </P>
<P CLASS="RBody">
<A NAME="pgfId-6551559"></A>&nbsp;</P>
<P CLASS="RBody">
<A NAME="pgfId-3415018"></A>For operations <CODE CLASS="Code">
:save-file</CODE>
 and <CODE CLASS="Code">
:load-file</CODE>
, <EM CLASS="Variable">
args</EM>
 is a lambda list<BR>
<EM CLASS="Variable">
filename</EM>
<CODE CLASS="Code">
 &amp;key </CODE>
<EM CLASS="Variable">
selection</EM>
<CODE CLASS="Code">
 </CODE>
<EM CLASS="Variable">
format</EM>
<CODE CLASS="Code">
 </CODE>
<EM CLASS="Variable">
plain-text</EM>
</P>
<P CLASS="RBody">
<A NAME="pgfId-3425307"></A><EM CLASS="Variable">
filename</EM>
 is the file to save or load.</P>
<P CLASS="RBody">
<A NAME="pgfId-3425227"></A><EM CLASS="Variable">
selection</EM>
 is a boolean, with default value <CODE CLASS="Code">
nil</CODE>
. </P>
<P CLASS="RBody">
<A NAME="pgfId-3426526"></A><EM CLASS="Variable">
format</EM>
 is <CODE CLASS="Code">
nil</CODE>
 or a keyword naming the file format. Values include <CODE CLASS="Code">
:rtf</CODE>
 and <CODE CLASS="Code">
:text</CODE>
 meaning Rich Text Format and text file respectively. </P>
<P CLASS="RBody">
<A NAME="pgfId-3426418"></A><EM CLASS="Variable">
plain-text</EM>
 is a boolean, with default value <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-3427088"></A>With <EM CLASS="Variable">
operation</EM>
 <CODE CLASS="Code">
:save-file</CODE>
, if <EM CLASS="Variable">
selection</EM>
 is true, only the current selection is saved. If <EM CLASS="Variable">
selection</EM>
 is <CODE CLASS="Code">
nil</CODE>
, all the text is saved. The default value of <EM CLASS="Variable">
format</EM>
 is <CODE CLASS="Code">
:rtf</CODE>
 and there are two further allowed values, <CODE CLASS="Code">
:rtfnoobjs</CODE>
 and <CODE CLASS="Code">
:textized</CODE>
. These are like <CODE CLASS="Code">
:rtf</CODE>
 and <CODE CLASS="Code">
:text</CODE>
 except in the way they deal with COM objects. See the documentation for SF_RTFNOOBJS and SF_TEXTIZED in the EM_STREAMOUT entry in the MSDN for details. When saving with <EM CLASS="Variable">
format</EM>
 <CODE CLASS="Code">
:rtf</CODE>
 or <CODE CLASS="Code">
:rtfnoobjs</CODE>
, if <EM CLASS="Variable">
plain-text</EM>
 is true, then keywords that are not common to all languages are ignored. With other values of <EM CLASS="Variable">
format</EM>
, <EM CLASS="Variable">
plain-text</EM>
 has no effect.</P>
<P CLASS="RBody">
<A NAME="pgfId-3425465"></A>With <EM CLASS="Variable">
operation</EM>
 <CODE CLASS="Code">
:load-file</CODE>
, if <EM CLASS="Variable">
selection</EM>
 is true, the unselected text is preserved. If there is a selection, the new text replaces it. If there is no selection, the new text is inserted at the current insertion point. If <EM CLASS="Variable">
selection</EM>
 is <CODE CLASS="Code">
nil</CODE>
, all the text is replaced. The default value of <EM CLASS="Variable">
format</EM>
 is <CODE CLASS="Code">
nil</CODE>
, meaning that the RTF signature is relied upon to indicate a Rich Text Format file. If <EM CLASS="Variable">
plain-text</EM>
 is true, then keywords that are not common to all languages are ignored.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3427150"></A>Example</H5>
<PRE CLASS="RCode-first"><A NAME="pgfId-3427222"></A>(setq rtp </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3427223"></A>      (capi:contain </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3427224"></A>       (make-instance </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3427225"></A>        'capi:rich-text-pane </PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-3427226"></A>        :text (format nil &quot;First paragraph.&#126;%Second paragraph, a little longer.&#126;%Another paragraph, which should be long long enough that it spans more than one line. &#126;%&quot; ))))</PRE>
<P CLASS="RBody">
<A NAME="pgfId-3427228"></A>Set the selection to characters 9 to 18:</P>
<CODE CLASS="RCode-line">
<A NAME="pgfId-3427230"></A>(capi:rich-text-pane-operation rtp :set-selection 9 18)</CODE>
<P CLASS="RBody">
<A NAME="pgfId-3427232"></A>Write all the text to a file in text format:</P>
<PRE CLASS="RCode-first"><A NAME="pgfId-3430292"></A>(capi:rich-text-pane-operation </PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-3430293"></A> rtp :save-file &quot;mydoc.txt&quot; :format :text)</PRE>
<P CLASS="RBody">
<A NAME="pgfId-3427236"></A>Paste:</P>
<CODE CLASS="RCode-line">
<A NAME="pgfId-3427238"></A>(capi:rich-text-pane-operation rtp :paste)</CODE>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3410370"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-3391620"></A><A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A><BR>
<A HREF="capiref-360.htm#58824" CLASS="XRef">rich-text-version</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-359.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-357.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
