<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 set-rich-text-pane-character-format
</TITLE>

<LINK REL="next" HREF="capiref-396.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-394.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-4.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-4.htm">1 CAPI Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-396.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-394.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-3367168"></A><A NAME="91837"></A>set<A NAME="marker-4227814"></A>-rich-text-pane-character-format</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-3367169"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3367170"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-3367171"></A>Sets the character format.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4227805"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-4227806"></A>capi</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-6119931"></A>Signature</H5>
<P CLASS="RSignature">
<A NAME="pgfId-6119932"></A>set-rich-text-pane-character-format <EM CLASS="Variable">
pane</EM>
 &amp;key <EM CLASS="Variable">
selection</EM>
 <EM CLASS="Variable">
attributes-plist</EM>
 =&gt; <EM CLASS="Variable">
result</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-6119890"></A>Arguments</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3367179"></A><EM CLASS="Variable">
pane</EM>
</P>
<P CLASS="RDescription-C">A <A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A>.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-10291393"></A><EM CLASS="Variable">
selection</EM>
</P>
<P CLASS="RDescription-C">Must be <CODE CLASS="Code">
t</CODE>
. This argument is deprecated.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3367559"></A><EM CLASS="Variable">
attributes-plist</EM>
</P>
<P CLASS="RDescription-C">A plist or <CODE CLASS="Code">
:default</CODE>
.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3367181"></A>Values</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3367182"></A><EM CLASS="Variable">
result</EM>
</P>
<P CLASS="RDescription-C">A plist.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3367183"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-3367184"></A>The function <CODE CLASS="Code">
set-rich-text-pane-character-format</CODE>
 sets current character attributes for text in <EM CLASS="Variable">
pane</EM>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-10269631"></A>If there is a current selection in the pane, then the attributes are set for the selected text. If there is no selection, then it sets the &quot;typing attributes&quot;, which are applied to characters that are typed by the user. Note that any cursor movement changes these attributes, so the setting is ephemeral.</P>
<P CLASS="RBody">
<A NAME="pgfId-10271066"></A>The <EM CLASS="Variable">
selection</EM>
 argument is deprecated. If <EM CLASS="Variable">
selection</EM>
 is <CODE CLASS="Code">
nil</CODE>
 an error is signalled. The default value of <EM CLASS="Variable">
selection</EM>
 is <CODE CLASS="Code">
t</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-8934303"></A>If <EM CLASS="Variable">
attributes-plist</EM>
 is the symbol <CODE CLASS="Code">
:default</CODE>
 then the default character format of the pane (that is, the value of the <A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A> initarg <CODE CLASS="Code">
:character-format</CODE>
) is used. Otherwise <EM CLASS="Variable">
attributes-plist</EM>
 is a plist of keywords and values. These are the valid keywords on Microsoft Windows and Cocoa:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3371087"></A><CODE CLASS="Code">
:bold</CODE>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3371107"></A><CODE CLASS="Code">
:italic</CODE>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3371922"></A><CODE CLASS="Code">
:underline</CODE>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3371100"></A><CODE CLASS="Code">
:face</CODE>
</P>
<P CLASS="RDescription-C">A string naming a font.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3371976"></A><CODE CLASS="Code">
:color</CODE>
</P>
<P CLASS="RDescription-C">A color spec or alias specifying the foreground color.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3372550"></A><CODE CLASS="Code">
:size</CODE>
</P>
<P CLASS="RDescription-C">The size of the font.</P>
<P CLASS="RBody">
<A NAME="pgfId-6527473"></A>Additionally these <EM CLASS="Variable">
attributes-plist</EM>
 keywords are valid on Microsoft Windows only:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-6527476"></A><CODE CLASS="Code">
:strikeout</CODE>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-6527481"></A><CODE CLASS="Code">
:offset</CODE>
</P>
<P CLASS="RDescription-C">An integer specifying the vertical offset of characters from the line (a positive value makes them superscript and a negative value makes them subscript).</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-10268902"></A><CODE CLASS="Code">
:protected</CODE>
</P>
<P CLASS="RDescription-C">A boolean. See the description of <EM CLASS="Variable">
protected-callback</EM>
 in <A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A>.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-6527483"></A><CODE CLASS="Code">
:charset</CODE>
</P>
<P CLASS="RDescription-C">A cons <CODE CLASS="Code">
(</CODE>
<EM CLASS="Variable">
charset</EM>
<CODE CLASS="Code">
 . </CODE>
<EM CLASS="Variable">
pitch-and-family</EM>
<CODE CLASS="Code">
)</CODE>
 where <EM CLASS="Variable">
charset</EM>
 has the value of a Microsoft Windows charset identifier, and <EM CLASS="Variable">
pitch-and-family</EM>
 is the value of <CODE CLASS="Code">
(logior </CODE>
<EM CLASS="Variable">
pitch</EM>
 <EM CLASS="Variable">
family</EM>
<CODE CLASS="Code">
)</CODE>
 where pitch and family have the value of a Windows pitch and a Windows font family respectively.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-10270071"></A>Compatibility note</H5>
<P CLASS="RBody">
<A NAME="pgfId-10270083"></A>The value <CODE CLASS="Code">
nil</CODE>
 for the keyword argument <CODE CLASS="Code">
:selection</CODE>
 is not supported in LispWorks 6.1 and later. See the description above for details of the current behavior with respect to the current selection in the <A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A>.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3374818"></A>Example</H5>
<P CLASS="RBody">
<A NAME="pgfId-3377179"></A><B CLASS="Bold">
Note:</B>
 This example uses some features which are supported only on Microsoft Windows:</P>
<PRE CLASS="RCode-first"><A NAME="pgfId-6534215"></A>(defun ok-to-edit-p (pane start end s)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3377180"></A>  (declare (ignore pane))</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3377181"></A>  (capi:prompt-for-confirmation </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3377182"></A>   (format nil &quot;Editing&#126;:[ &#126;; selection &#126;]from &#126;a to &#126;a&quot;</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375024"></A>           s start end)))</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375025"></A>&nbsp;</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375026"></A>(setq rtp </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375027"></A>      (capi:contain </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375028"></A>       (make-instance </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375029"></A>        'capi:rich-text-pane </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375030"></A>        :protected-callback 'ok-to-edit-p</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375031"></A>        :character-format </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375032"></A>        '(:size 14  :color :red)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375033"></A>        :visible-min-height 300</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375034"></A>        :visible-min-width 400</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375035"></A>        :paragraph-format </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375036"></A>        '(:start-indent 20 :offset -15)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375037"></A>        :text-limit 160</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-3375038"></A>        :text (format nil &quot;First paragraph.&#126;%Second paragraph, a little longer.&#126;%Another paragraph, which should be long long enough that it spans more than one line. &#126;%&quot; ))))</PRE>
<P CLASS="RBody">
<A NAME="pgfId-3375040"></A>Enter some characters in the rich text window and select a range.</P>
<P CLASS="RBody">
<A NAME="pgfId-3375042"></A>Set the selection to blue:</P>
<PRE CLASS="RCode-first"><A NAME="pgfId-3375044"></A>(capi:set-rich-text-pane-character-format </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375045"></A> rtp</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3375046"></A> :attributes-plist '(:color :blue))</PRE>
<P CLASS="RBody">
<A NAME="pgfId-3375049"></A>Make it protected:</P>
<PRE CLASS="RCode-first"><A NAME="pgfId-3375906"></A>(capi:set-rich-text-pane-character-format</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-3375907"></A> rtp :attributes-plist '(:protected t))</PRE>
<P CLASS="RBody">
<A NAME="pgfId-3375018"></A>Now try to delete a character, and also to delete the selection. In both cases the <CODE CLASS="Code">
ok-to-edit-p</CODE>
 callback is called.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-3367192"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-3367150"></A><A HREF="capiref-356.htm#74730" CLASS="XRef">rich-text-pane</A><BR>
<A HREF="capiref-357.htm#51927" CLASS="XRef">rich-text-pane-character-format</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-396.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-394.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
