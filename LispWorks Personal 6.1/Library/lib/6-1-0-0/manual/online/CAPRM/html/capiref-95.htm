<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 drag-pane-object
</TITLE>

<LINK REL="next" HREF="capiref-96.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-94.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-4.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-4.htm">1 CAPI Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-96.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-94.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-7552048"></A><A NAME="marker-7630746"></A><A NAME="29125"></A>drag<A NAME="marker-7552047"></A>-pane-object</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-7552049"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552050"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-7552051"></A>Initiates a dragging operation</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552052"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-7552053"></A>capi</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552686"></A>Signature</H5>
<P CLASS="RSignature">
<A NAME="pgfId-7552687"></A>drag-pane-object <EM CLASS="Variable">
pane</EM>
 <EM CLASS="Variable">
value</EM>
 &amp;key <EM CLASS="Variable">
string</EM>
 <EM CLASS="Variable">
plist</EM>
 <EM CLASS="Variable">
image-function</EM>
 <EM CLASS="Variable">
operations</EM>
 =&gt; <EM CLASS="Variable">
operation</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552688"></A>Arguments</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552919"></A><EM CLASS="Variable">
pane</EM>
</P>
<P CLASS="RDescription-C">A pane</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552920"></A><EM CLASS="Variable">
value</EM>
</P>
<P CLASS="RDescription-C">An object to be dragged</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552921"></A><EM CLASS="Variable">
string</EM>
</P>
<P CLASS="RDescription-C">A string to be dragged or <CODE CLASS="Code">
nil</CODE>
</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552922"></A><EM CLASS="Variable">
plist</EM>
</P>
<P CLASS="RDescription-C">A plist of formats and objects to be dragged</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552923"></A><EM CLASS="Variable">
image-function</EM>
</P>
<P CLASS="RDescription-C">A function or <CODE CLASS="Code">
nil</CODE>
</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552058"></A><EM CLASS="Variable">
operations</EM>
</P>
<P CLASS="RDescription-C">A list of operation keywords allowed for the dragged objects</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552059"></A>Values</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7552060"></A><EM CLASS="Variable">
operation</EM>
</P>
<P CLASS="RDescription-C">One of the operation keywords</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552061"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-7553009"></A>The function <CODE CLASS="Code">
drag-pane-object</CODE>
 initiates a dragging operation from within the pane <EM CLASS="Variable">
pane</EM>
. It can only be called from within the button <CODE CLASS="Code">
:press</CODE>
 or button <CODE CLASS="Code">
:motion</CODE>
 callbacks of the <EM CLASS="Variable">
input-model</EM>
 of an <A HREF="capiref-275.htm#35026" CLASS="XRef">output-pane</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-7553010"></A>The <EM CLASS="Variable">
value</EM>
, <EM CLASS="Variable">
string</EM>
 and <EM CLASS="Variable">
plist</EM>
 arguments are combined to provide an object to be dragged in various formats.</P>
<P CLASS="RBody">
<A NAME="pgfId-7553011"></A><EM CLASS="Variable">
value</EM>
 can be any Lisp object (not necessarily a string) to make available for dropping into a pane within the local Lisp image.</P>
<P CLASS="RBody">
<A NAME="pgfId-7553012"></A><EM CLASS="Variable">
string</EM>
 can be a string representation of <EM CLASS="Variable">
value</EM>
 to make available, or <CODE CLASS="Code">
nil</CODE>
. If <EM CLASS="Variable">
string</EM>
 is <CODE CLASS="Code">
nil</CODE>
 and <EM CLASS="Variable">
value</EM>
 is a string, then that will be made available as the string.</P>
<P CLASS="RBody">
<A NAME="pgfId-7553013"></A><EM CLASS="Variable">
plist</EM>
 is a property list of additional format/value pairs to make available. The currently supported formats are as described for <A HREF="capiref-386.htm#28147" CLASS="XRef">set-drop-object-supported-formats</A>. You can make more than one format available simultaneously. </P>
<P CLASS="RBody">
<A NAME="pgfId-7553014"></A><EM CLASS="Variable">
image-function</EM>
 provides a graphical image for use during the dragging operation on Cocoa. If <EM CLASS="Variable">
image-function</EM>
 is supplied, then it should be a function of one argument. It might be called to provide an image for use during the dragging operation. The function <EM CLASS="Variable">
image-function</EM>
 should return three values: a <A HREF="capiref-574.htm#77313" CLASS="XRef">image</A> object, an x offset and a y offset. The x and y offsets are the position within the image where the mouse should be located. If the image is <CODE CLASS="Code">
nil</CODE>
 or <EM CLASS="Variable">
image-function</EM>
 is not supplied then a default image is generated. If the x or y offsets are <CODE CLASS="Code">
nil</CODE>
 or not returned then the image is positioned with the mouse at its center point. The image that is returned by <EM CLASS="Variable">
image-function</EM>
 is freed automatically in the end of dragging operation. It  must be a new image, and cannot be reused.</P>
<P CLASS="RBody">
<A NAME="pgfId-7553016"></A><EM CLASS="Variable">
operations</EM>
 should be a list of operation keywords that the pane will allow the target application to perform. The operation keywords are <CODE CLASS="Code">
:copy</CODE>
, <CODE CLASS="Code">
:move</CODE>
 and <CODE CLASS="Code">
:link</CODE>
 as described for the effect in <A HREF="capiref-105.htm#50122" CLASS="XRef">drop-object-drop-effect</A>. If certain platform-specific modifier keys are pressed, then some of the operations will be ignored.</P>
<P CLASS="RBody">
<A NAME="pgfId-7552062"></A>The return value <EM CLASS="Variable">
operation</EM>
 indicates which operation was performed by the application where the dragged object was dropped. The value will be <CODE CLASS="Code">
:none</CODE>
 if the object was not dropped anywhere or dragging was abandoned (for example, by the user hitting the <CODE CLASS="Code">
Escape</CODE>
 key). If <EM CLASS="Variable">
operation</EM>
 is <CODE CLASS="Code">
:move</CODE>
, then you should update the data structures in your application to remove the object that was dragged.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-9618380"></A>Notes</H5>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-9618422"></A><CODE CLASS="Code">
drag-pane-object</CODE>
 is not supported on X11/Motif. See <A HREF="capiref-408.htm#40919" CLASS="XRef">simple-pane</A> for information about drop callbacks.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-9618666"></A><EM CLASS="Variable">
image-function</EM>
 is only called on Cocoa. There is no way to specify an image when dragging on Microsoft Windows.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-9618711"></A>If <CODE CLASS="Code">
:image</CODE>
 is supplied in <EM CLASS="Variable">
plist</EM>
, the dragging mechanism automatically frees the <A HREF="capiref-574.htm#77313" CLASS="XRef">image</A> object as if by <A HREF="capiref-555.htm#48924" CLASS="XRef">free-image</A>  when it no longer needs it.</LI>
</OL>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-9618370"></A>Example</H5>
<P CLASS="RBody">
<A NAME="pgfId-7635829"></A>See <CODE CLASS="Code">
examples/capi/output-panes/drag-and-drop.lisp</CODE>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-7552071"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-7552075"></A><A HREF="capiref-408.htm#40919" CLASS="XRef">simple-pane</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-96.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-94.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
