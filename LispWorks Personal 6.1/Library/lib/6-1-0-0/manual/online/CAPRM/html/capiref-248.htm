<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 menu-object
</TITLE>

<LINK REL="next" HREF="capiref-249.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-247.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-4.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-4.htm">1 CAPI Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-249.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-247.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-901203"></A><A NAME="21554"></A>menu<A NAME="marker-4172928"></A>-object</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-901562"></A>Class</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901204"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-901209"></A>The class <CODE CLASS="Code">
menu-object</CODE>
 is the superclass of all menu objects, and provides functionality for handling generic aspects of menus, menu components and menu items. </P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4172917"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-4172918"></A>capi</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901212"></A>Superclasses</H5>
<P CLASS="RSignature">
<A NAME="pgfId-901214"></A><A HREF="capiref-26.htm#13019" CLASS="XRef">callbacks</A></P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901216"></A>Subclasses</H5>
<P CLASS="RSignature">
<A NAME="pgfId-901218"></A><A HREF="capiref-448.htm#31725" CLASS="XRef">titled-menu-object</A></P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901220"></A>Initargs</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-901223"></A><CODE CLASS="Code">
:popup-callback</CODE>
<A NAME="marker-952884"></A><A NAME="marker-952885"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-901610"></A>Callback before the menu appears.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-901224"></A><CODE CLASS="Code">
:enabled-function</CODE>
<A NAME="marker-952886"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-901611"></A>Returns true if the menu is enabled.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-901225"></A><CODE CLASS="Code">
:enabled-slot</P>
<P CLASS="RDescription-C"></CODE>
<A NAME="marker-952887"></A>The object is enabled if the slot is non-nil.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-901226"></A><CODE CLASS="Code">
:callback</CODE>
<A NAME="marker-952888"></A></P>
<P CLASS="RDescription-C">The selection callback for the object.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-901227"></A><CODE CLASS="Code">
:callback-data-function</CODE>
<A NAME="marker-952889"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-901612"></A>A function to return data for the callback.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-3717617"></A><CODE CLASS="Code">
:setup-callback-argument</CODE>
<A NAME="marker-3717616"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-3717618"></A>If non-nil, specifies the argument to the setup callbacks (listed below) that are used to set up the <CODE CLASS="Code">
menu-object</CODE>
.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901229"></A>Accessors</H5>
<P CLASS="RSignature">
<A NAME="pgfId-901231"></A><A NAME="marker-3801323"></A>menu-popup-callback</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-4288434"></A>Readers</H5>
<P CLASS="RSignature">
<A NAME="pgfId-4288599"></A><A NAME="marker-4288603"></A>menu-object-enabled</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901632"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-901236"></A>When the menu object is about to appear on the screen, the CAPI does the following:</P>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-3717642"></A>The setup callback <EM CLASS="Variable">
items-function</EM>
  (if there is one) is called and the result is used to set the items, for <A HREF="capiref-245.htm#19220" CLASS="XRef">menu</A> and <A HREF="capiref-246.htm#24767" CLASS="XRef">menu-component</A>. The argument passed to <EM CLASS="Variable">
items-function</EM>
 is the same as for the other setup callbacks (see below). </LI>
<LI CLASS="RStep">
<A NAME="pgfId-3740162"></A>The <EM CLASS="Variable">
popup-callback</EM>
 (if there is one) is called and can make arbitrary changes to that object. The <EM CLASS="Variable">
popup-callback</EM>
 is always called with the menu object, regardless of the value of <EM CLASS="Variable">
setup-callback-argument</EM>
.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-3740346"></A>The other setup callbacks are called  to set up the selection, enabled state and title. These setup callbacks include <EM CLASS="Variable">
enabled-function</EM>
 for all <CODE CLASS="Code">
menu-object</CODE>
s and <EM CLASS="Variable">
title-function</EM>
 for all <A HREF="capiref-448.htm#31725" CLASS="XRef">titled-menu-object</A>s. The additional setup callbacks for <EM CLASS="Variable">
<A HREF="capiref-246.htm#24767" CLASS="XRef">menu-component</A></EM>
 are <EM CLASS="Variable">
selection-function</EM>
, <EM CLASS="Variable">
selected-item-function</EM>
, and <EM CLASS="Variable">
selected-items-function</EM>
. <A HREF="capiref-247.htm#29489" CLASS="XRef">menu-item</A> has the additional setup callback <EM CLASS="Variable">
selected-function</EM>
. </LI>
<P CLASS="RStep-C">
<A NAME="pgfId-3728096"></A>By default <EM CLASS="Variable">
setup-callback-argument</EM>
 is <CODE CLASS="Code">
nil</CODE>
, which means that each of the setup callbacks is called on the interface of the <CODE CLASS="Code">
menu-object</CODE>
. If <EM CLASS="Variable">
setup-callback-argument</EM>
 is non-nil, then it is passed (instead of the interface) as the argument to each of the setup callbacks.</P>
<LI CLASS="RStep">
<A NAME="pgfId-1129519"></A>The menu containing the object appears with all of the changes made.</LI>
</OL>
<P CLASS="RBody">
<A NAME="pgfId-4288615"></A>Note that <EM CLASS="Variable">
enabled-slot</EM>
 is a short-hand means of creating an <EM CLASS="Variable">
enabled-function</EM>
 which checks the value of a slot in the menu object's interface.</P>
<P CLASS="RBody">
<A NAME="pgfId-4288684"></A>The enabled state of a <CODE CLASS="Code">
menu-object</CODE>
 is computed each time the menu is displayed, using <EM CLASS="Variable">
enabled-function</EM>
 or <EM CLASS="Variable">
enabled-slot</EM>
. Therefore the accessor <CODE CLASS="Code">
menu-object-enabled</CODE>
 is only useful as a reader.</P>
<P CLASS="RBody">
<A NAME="pgfId-901243"></A>The <EM CLASS="Variable">
callback</EM>
 argument is placed in the <EM CLASS="Variable">
selection-callback</EM>
, <EM CLASS="Variable">
extend-callback</EM>
 and <EM CLASS="Variable">
retract-callback</EM>
 slots unless these are given explicitly, and so will get called when the menu object is selected or deselected. </P>
<P CLASS="RBody">
<A NAME="pgfId-2178581"></A>The <CODE CLASS="Code">
</CODE>
<EM CLASS="Variable">
callback-data-function</EM>
 is a function that is called with no arguments and the value it returns is used as the data to the callbacks. </P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-9323410"></A>Notes</H5>
<P CLASS="RBody">
<A NAME="pgfId-9323418"></A>The function <EM CLASS="Variable">
enabled-function</EM>
 should not display a dialog or do anything that may cause the system to hang. In general this means interacting with anything outside the Lisp image, including files, databases and so on.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-901248"></A>Example</H5>
<PRE CLASS="RCode-first"><A NAME="pgfId-901250"></A>(capi:contain (make-instance</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-901252"></A>               'capi:menu-item</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-901253"></A>               :text &quot;Press Me&quot;</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-901254"></A>               :enabled-function #'(lambda (item)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-901255"></A>                                     (eq (random 2)</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-1132315"></A>                                     1))))</PRE>
<P CLASS="RBody">
<A NAME="pgfId-3740403"></A>The next example illustrates the use of <EM CLASS="Variable">
setup-callback-argument</EM>
. The <CODE CLASS="Code">
initialize-instance</CODE>
 method adds to the &quot;Some Numbers&quot; menu a sub-menu that lists the selected items in the <A HREF="capiref-214.htm#30299" CLASS="XRef">list-panel</A>. By using <EM CLASS="Variable">
setup-callback-argument</EM>
 in this menu, the setup callbacks (in this case <EM CLASS="Variable">
enabled-function</EM>
 and <EM CLASS="Variable">
items-function</EM>
) are called directly on the <A HREF="capiref-214.htm#30299" CLASS="XRef">list-panel</A>.</P>
<P CLASS="RBody">
<A NAME="pgfId-3740404"></A>Note that, while this example uses a CAPI object as the <EM CLASS="Variable">
setup-callback-argument</EM>
, any object of any type can be used.</P>
<PRE CLASS="RCode-first"><A NAME="pgfId-3742518"></A>(capi:define-interface my-interface ()</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742519"></A>  ()</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742520"></A>  (:panes</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742521"></A>   (list-panel</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742522"></A>    capi:list-panel</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742523"></A>    :items '(1 2 3 4 5 6 7 8 9 0)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742524"></A>    :interaction :extended-selection</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742525"></A>    :visible-min-height '(character 10)))</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742526"></A>  (:menus</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742527"></A>   (a-menu</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742528"></A>    &quot;Some Numbers&quot;</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742529"></A>    (&quot;One&quot; &quot;Two&quot;)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742530"></A>    ))</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742531"></A>  (:menu-bar a-menu))</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742532"></A>&nbsp;</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742533"></A>(defmethod initialize-instance :after </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742534"></A>  ((self my-interface) &amp;key)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742535"></A>  (with-slots (a-menu list-panel) self</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742536"></A>    (setf (capi:menu-items a-menu)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742537"></A>          (append </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742538"></A>           (capi:menu-items a-menu)</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742539"></A>           (list </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742540"></A>            (make-instance 'capi:menu</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742541"></A>                           :items-function </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742542"></A>                           'capi:choice-selected-items</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742543"></A>                           :setup-callback-argument </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742544"></A>                           list-panel</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742545"></A>                           :enabled-function</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742546"></A>                           'capi:choice-selection</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742547"></A>                           :title </PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742548"></A>                           &quot;Selected Items&quot;))))))</PRE>
<PRE CLASS="RCode-body"><A NAME="pgfId-3742549"></A>&nbsp;</PRE>
<PRE CLASS="RCode-last"><A NAME="pgfId-3740384"></A>(capi:display (make-instance 'my-interface))</PRE>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1132317"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-1132321"></A><A HREF="capiref-245.htm#19220" CLASS="XRef">menu</A> <BR>
<A HREF="capiref-247.htm#29489" CLASS="XRef">menu-item</A> <BR>
<A HREF="capiref-246.htm#24767" CLASS="XRef">menu-component</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-249.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-247.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
