<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 cocoa-default-application-interface
</TITLE>

<LINK REL="next" HREF="capiref-42.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-40.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-4.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-4.htm">1 CAPI Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-42.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-40.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-5703609"></A><A NAME="30158"></A>cocoa<A NAME="marker-5708519"></A>-default<A NAME="marker-5708695"></A>-application-interface</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-5703610"></A>Class</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5703611"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-5703612"></A>The class supporting application menus and message processing for a Cocoa application.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5703613"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-5703614"></A>capi</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5703615"></A>Superclasses</H5>
<P CLASS="RSignature">
<A NAME="pgfId-5703619"></A><A HREF="capiref-184.htm#30394" CLASS="XRef">interface</A></P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5703623"></A>Initargs</H5>
<P CLASS="RDescription">
<A NAME="pgfId-5703625"></A><CODE CLASS="Code">
:message-callback</CODE>
<A NAME="marker-5703624"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-5708591"></A>A function or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-5703627"></A><CODE CLASS="Code">
:application-menu</CODE>
<A NAME="marker-5703626"></A></P>
<P CLASS="RDescription-C">
<A NAME="pgfId-5703628"></A><CODE CLASS="Code">
nil</CODE>
, a <A HREF="capiref-245.htm#19220" CLASS="XRef">menu</A>, or the name of a slot containing  a <A HREF="capiref-245.htm#19220" CLASS="XRef">menu</A> in the application interface.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-7290522"></A><CODE CLASS="Code">
:dock-menu</CODE>
<A NAME="marker-7290534"></A></P>
<P CLASS="RDescription-C"><CODE CLASS="Code">
nil</CODE>
, a <A HREF="capiref-245.htm#19220" CLASS="XRef">menu</A>, or a function designator.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5703629"></A>Accessors</H5>
<P CLASS="RSignature">
<A NAME="pgfId-5703631"></A><A NAME="marker-5703630"></A>application-interface-message-callback<BR>
<A NAME="marker-5708572"></A>application-interface-application-menu<BR>
<A NAME="marker-7290539"></A>application-interface-dock-menu</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5703633"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-5714523"></A>The class <CODE CLASS="Code">
cocoa-default-application-interface</CODE>
 supports the application menu, application messages and other functionality for a Cocoa application.</P>
<P CLASS="RBody">
<A NAME="pgfId-10683634"></A>All Cocoa applications in LispWorks for Macintosh have an application interface, which is a hidden interface that provides the following:</P>
<OL>
<LI CLASS="RStep-1">
<A NAME="pgfId-10683636"></A>The application menu (the leftmost menu in the menu bar, named after the application). See <EM CLASS="Variable">
application-menu</EM>
 below.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-10683638"></A>The menu bar items that are displayed when no other interfaces are on the screen.  See <EM CLASS="Variable">
menu-bar-items</EM>
 in <A HREF="capiref-184.htm#30394" CLASS="XRef">interface</A> and <EM CLASS="Variable">
menu-bar</EM>
 in <A HREF="capiref-69.htm#25433" CLASS="XRef">define-interface</A>.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-10683640"></A>An optional Dock context menu. See <EM CLASS="Variable">
dock-menu</EM>
 below.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-10683642"></A>Optional application message processing. See <EM CLASS="Variable">
message-callback</EM>
 below.</LI>
<LI CLASS="RStep">
<A NAME="pgfId-10683644"></A>Control over the lifecycle and <EM CLASS="Variable">
display-state</EM>
 of the application as a whole.</LI>
</OL>
<P CLASS="RBody">
<A NAME="pgfId-10683646"></A>If you wish to override the defaults, then you should first define a subclass of <CODE CLASS="Code">
cocoa-default-application-interface</CODE>
 with your changes. Then set a single instance of this subclass as the application interface by calling <A HREF="capiref-377.htm#61976" CLASS="XRef">set-application-interface</A> before any CAPI functions that make the screen object (such as <A HREF="capiref-59.htm#18970" CLASS="XRef">convert-to-screen</A> and <A HREF="capiref-76.htm#40005" CLASS="XRef">display</A>).</P>
<P CLASS="RBody">
<A NAME="pgfId-10683628"></A>Do not call <A HREF="capiref-76.htm#40005" CLASS="XRef">display</A> with a subclass of <CODE CLASS="Code">
cocoa-default-application-interface</CODE>
 - the application interface does not have a window on the screen and should be created in addition to the visible interfaces in your application.</P>
<P CLASS="RBody">
<A NAME="pgfId-5714524"></A>When non-nil, <EM CLASS="Variable">
message-callback</EM>
 should be a function with signature </P>
<P CLASS="RSignature">
<A NAME="pgfId-5708698"></A><EM CLASS="Variable">
interface</EM>
 <EM CLASS="Variable">
message</EM>
 &amp;rest <EM CLASS="Variable">
args</EM>
</P>
<P CLASS="RBody">
<A NAME="pgfId-9329492"></A><EM CLASS="Variable">
message-callback</EM>
 will be called for various application messages. The <EM CLASS="Variable">
interface</EM>
 argument will be the application interface and the <EM CLASS="Variable">
message</EM>
 argument will be a keyword. The <EM CLASS="Variable">
message</EM>
 argument will be one of the following:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-9329509"></A><CODE CLASS="Code">
:open-file</CODE>
</P>
<P CLASS="RDescription-C">This message is invoked when the user double-clicks on a document associated with the application or drags a document into the application icon. The <EM CLASS="Variable">
args</EM>
 contain the name of the file to open.</P>
<P CLASS="RDescription">
<A NAME="pgfId-9329512"></A><A NAME="marker-9329919"></A><CODE CLASS="Code">
:finished-launching</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-9329667"></A>This message is invoked just after the user has started the application and all other initialization has been done (including any <CODE CLASS="Code">
:open-file</CODE>
 message if applicable). You can use it to open a default document for example. There are no <EM CLASS="Variable">
args</EM>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-10682481"></A><EM CLASS="Variable">
application-menu</EM>
 controls the application's main menu. If this is <CODE CLASS="Code">
nil</CODE>
, then a minimal application menu will be made using the title of the application interface, otherwise it should be a <A HREF="capiref-245.htm#19220" CLASS="XRef">menu</A> containing the usual items or the name of a slot containing such a menu in the application interface. Note that the <B CLASS="Button">
Quit</B>
 item in the <EM CLASS="Variable">
application-menu</EM>
 needs to call <A HREF="capiref-73.htm#10545" CLASS="XRef">destroy</A> on the interface, rather than call <A NAME="marker-10682595"></A><CODE CLASS="Code">
lw:quit</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-7290551"></A><EM CLASS="Variable">
dock-menu</EM>
 provides a menu for use by the Mac OS X Dock icon. If the value is <CODE CLASS="Code">
nil</CODE>
 (the default), then the standard menu is used. If <EM CLASS="Variable">
dock-menu</EM>
 is a function designator, it is called with the application interface as its argument when the menu is popped up and should return a menu. Otherwise <EM CLASS="Variable">
dock-menu</EM>
 should be a menu, which is used directly. The Dock will add the standard items such as <B CLASS="Button">
Quit</B>
 to the end of the menu you supply.</P>
<P CLASS="RBody">
<A NAME="pgfId-5708703"></A><A HREF="capiref-184.htm#30394" CLASS="XRef">interface</A>  initargs are interpreted as follows:</P>
<UL>
<LI CLASS="RBullet">
<A NAME="pgfId-5714798"></A>The <EM CLASS="Variable">
activate-callback</EM>
 is called when the application is activated or deactivated.</LI>
<LI CLASS="RBullet">
<A NAME="pgfId-8454881"></A>The <EM CLASS="Variable">
create-callback</EM>
 is called when the application starts up.</LI>
<LI CLASS="RBullet">
<A NAME="pgfId-5714799"></A>The <EM CLASS="Variable">
destroy-callback</EM>
 is called when the application shuts down.</LI>
<LI CLASS="RBullet">
<A NAME="pgfId-5714807"></A>The <EM CLASS="Variable">
confirm-destroy-function</EM>
 is called to confirm whether the application should shut down.</LI>
</UL>
<P CLASS="RBody">
<A NAME="pgfId-8454886"></A>All of these callbacks execute in the thread that runs the Cocoa event loop, so they can call CAPI and GP functions.</P>
<P CLASS="RBody">
<A NAME="pgfId-5708709"></A>The application interface also allows you to control aspects of the application. In particular:</P>
<UL>
<LI CLASS="RBullet">
<A NAME="pgfId-5708710"></A>The function <A HREF="capiref-73.htm#10545" CLASS="XRef">destroy</A> will cause the application to shut down.</LI>
<LI CLASS="RBullet">
<A NAME="pgfId-5708711"></A>The function <A HREF="capiref-456.htm#top-level-interface-display-state" CLASS="XRef">top-level-interface-display-state</A> will return <CODE CLASS="Code">
:hidden</CODE>
 if the whole application is hidden and will return <CODE CLASS="Code">
:normal</CODE>
 otherwise.</LI>
<LI CLASS="RBullet">
<A NAME="pgfId-5708712"></A>The function <CODE CLASS="Code">
(setf top-level-interface-display-state)</CODE>
 can be used to perform some operations typically found on the application menu. </LI>
</UL>
<P CLASS="RBody">
<A NAME="pgfId-5736567"></A>The <EM CLASS="Variable">
display-state</EM>
 value can one of:</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-5708713"></A><CODE CLASS="Code">
:normal</CODE>
</P>
<P CLASS="RDescription-C">Show the application and activate it</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-5708714"></A><CODE CLASS="Code">
:restore</CODE>
</P>
<P CLASS="RDescription-C">Show the application again without activating it</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-5708715"></A><CODE CLASS="Code">
:hidden</CODE>
</P>
<P CLASS="RDescription-C">Hide</P>
<P CLASS="RDescription">
<A NAME="pgfId-5708716"></A><CODE CLASS="Code">
:others-hidden</CODE>
</P>
<P CLASS="RDescription-C">
<A NAME="pgfId-5714902"></A>Hide Others</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-5708717"></A><CODE CLASS="Code">
:all-normal</CODE>
</P>
<P CLASS="RDescription-C">Show All</P>
<P CLASS="RBody">
<A NAME="pgfId-5714975"></A><B CLASS="Bold">
Note:</B>
 <CODE CLASS="Code">
cocoa-default-application-interface </CODE>
is implemented only in LispWorks for Macintosh with the Cocoa IDE.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5708720"></A>Example</H5>
<P CLASS="RBody">
<A NAME="pgfId-5714936"></A>See these files in the <CODE CLASS="Code">
examples</CODE>
 subdirectory of the LispWorks library:</P>
<P CLASS="RBody">
<A NAME="pgfId-9138392"></A><CODE CLASS="Code">
capi/applications/cocoa-application.lisp</CODE>
</P>
<P CLASS="RBody">
<A NAME="pgfId-9138393"></A><CODE CLASS="Code">
capi/applications/cocoa-application-single-window.lisp</CODE>
</P>
<P CLASS="RBody">
<A NAME="pgfId-9138394"></A><CODE CLASS="Code">
delivery/macos/multiple-window-application.lisp</CODE>
</P>
<P CLASS="RBody">
<A NAME="pgfId-5703634"></A><CODE CLASS="Code">
delivery/macos/single-window-application.lisp</CODE>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-5715000"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-5715008"></A><A HREF="capiref-377.htm#61976" CLASS="XRef">set-application-interface</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-42.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-40.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
