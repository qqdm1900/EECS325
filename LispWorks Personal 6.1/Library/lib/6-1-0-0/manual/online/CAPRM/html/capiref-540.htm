<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiref.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 externalize-and-write-image
</TITLE>

<LINK REL="next" HREF="capiref-541.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiref-539.htm" TYPE="text/html">
<LINK REL="up" HREF="capiref-495.htm" TYPE="text/html">
<LINK REL="top" HREF="capiref.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiref-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiref-693.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt; <A HREF="capiref.htm">CAPI Reference Manual</A> &gt; <A HREF="capiref-495.htm">2 GP Reference Entries</A><BR><BR>
</DIV><A HREF="capiref-541.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-539.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-495.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H4 CLASS="REntry">
<A NAME="pgfId-1525854"></A><A NAME="89695"></A><A NAME="marker-1547166"></A>externalize-and-write<A NAME="marker-1547185"></A>-image</H4>
<DIV>
<H5 CLASS="REntry-type">
<A NAME="pgfId-1525855"></A>Function</H5>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525856"></A>Summary</H5>
<P CLASS="RBody">
<A NAME="pgfId-1525857"></A>Externalizes and writes an image to file.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525858"></A>Package</H5>
<P CLASS="RSignature">
<A NAME="pgfId-1525859"></A>graphics-ports</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525860"></A>Signature</H5>
<P CLASS="RSignature">
<A NAME="pgfId-1525861"></A>externalize-and-write-image <EM CLASS="Variable">
gp</EM>
 <EM CLASS="Variable">
image</EM>
 <EM CLASS="Variable">
filename</EM>
 &amp;key <EM CLASS="Variable">
type</EM>
 <EM CLASS="Variable">
if-exists</EM>
 <EM CLASS="Variable">
errorp</EM>
 <EM CLASS="Variable">
x-hot</EM>
 <EM CLASS="Variable">
y-hot</EM>
 <EM CLASS="Variable">
quality</EM>
 &amp;allow-other-keys =&gt; <EM CLASS="Variable">
result</EM>
</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525862"></A>Arguments</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525863"></A><EM CLASS="Variable">
gp</EM>
</P>
<P CLASS="RDescription-C">A CAPI pane.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525864"></A><EM CLASS="Variable">
image</EM>
</P>
<P CLASS="RDescription-C">An <A HREF="capiref-574.htm#77313" CLASS="XRef">image</A> object.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525865"></A><EM CLASS="Variable">
filename</EM>
</P>
<P CLASS="RDescription-C">A file namestring or a pathname.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525866"></A><EM CLASS="Variable">
type</EM>
</P>
<P CLASS="RDescription-C">One of the keywords <CODE CLASS="Code">
:bmp</CODE>
, <CODE CLASS="Code">
:jpg</CODE>
, <CODE CLASS="Code">
:jpeg</CODE>
, <CODE CLASS="Code">
:png</CODE>
 and <CODE CLASS="Code">
:tiff</CODE>
. Other keywords may be supported, depending on the platform.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525867"></A><EM CLASS="Variable">
if-exists</EM>
</P>
<P CLASS="RDescription-C">One of the keywords <CODE CLASS="Code">
:error</CODE>
, <CODE CLASS="Code">
:new-version</CODE>
, <CODE CLASS="Code">
:rename</CODE>
, <CODE CLASS="Code">
:rename-and-delete</CODE>
, <CODE CLASS="Code">
:overwrite</CODE>
, <CODE CLASS="Code">
:append</CODE>
 and <CODE CLASS="Code">
:supersede</CODE>
, or <CODE CLASS="Code">
nil</CODE>
.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525868"></A><EM CLASS="Variable">
errorp</EM>
</P>
<P CLASS="RDescription-C">A boolean.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525869"></A><EM CLASS="Variable">
x-hot</EM>
</P>
<P CLASS="RDescription-C">A non-negative integer.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525870"></A><EM CLASS="Variable">
y-hot</EM>
</P>
<P CLASS="RDescription-C">A non-negative integer.</P>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525871"></A><EM CLASS="Variable">
quality</EM>
</P>
<P CLASS="RDescription-C">An integer in the range [0,100].</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525872"></A>Values</H5>
<P CLASS="RDescription-Item">
<A NAME="pgfId-1525873"></A><EM CLASS="Variable">
result</EM>
</P>
<P CLASS="RDescription-C">A filename or <CODE CLASS="Code">
nil</CODE>
.</P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525874"></A>Description</H5>
<P CLASS="RBody">
<A NAME="pgfId-1525875"></A>The function <CODE CLASS="Code">
externalize-and-write-image</CODE>
 externalizes and writes an <A HREF="capiref-574.htm#77313" CLASS="XRef">image</A> object to file.</P>
<P CLASS="RBody">
<A NAME="pgfId-1525876"></A>The output image type can be specified by the argument <EM CLASS="Variable">
type</EM>
. If <EM CLASS="Variable">
type</EM>
 is not supplied then the output image type is determined by the file type in the <EM CLASS="Variable">
filename</EM>
. </P>
<P CLASS="RBody">
<A NAME="pgfId-1525877"></A>If <EM CLASS="Variable">
type</EM>
 is supplied, it must be a keyword which specifies a known type, as returned by <A HREF="capiref-590.htm#50874" CLASS="XRef">list-known-image-formats</A> with <EM CLASS="Variable">
for-writing-too</EM>
 <CODE CLASS="Code">
t</CODE>
. The types <CODE CLASS="Code">
:bmp</CODE>
, <CODE CLASS="Code">
:jpg</CODE>
, <CODE CLASS="Code">
:png</CODE>
 and <CODE CLASS="Code">
:tiff</CODE>
 are known on all platforms (except Motif). Additionally, <CODE CLASS="Code">
:jpeg</CODE>
 is an as alias for <CODE CLASS="Code">
:jpg</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1525878"></A>If <EM CLASS="Variable">
type</EM>
 is not supplied, then the file extension of the filename is used to &quot;guess&quot; the type. In general it is the extension uppercased and interned in the keyword package.  It also recognizes some special cases:</P>
<TABLE BORDER="1">
<CAPTION>
<H6 CLASS="Table">
<A NAME="pgfId-1527875"></A>Image type from file extension: special cases<DIV>
<IMG SRC="capiref-6.gif">
</DIV>
</H6>
</CAPTION>
<TR>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-1527847"></A>File extension</P>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<P CLASS="CellHeading">
<A NAME="pgfId-1527849"></A>Image type</P>
</TH>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1529124"></A>&quot;TIF&quot;</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1527853"></A><CODE CLASS="Code">
:tiff</CODE>
</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1534315"></A>&quot;DIB&quot;</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1527857"></A><CODE CLASS="Code">
:bmp</CODE>
</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1540577"></A>&quot;JPE&quot;</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1527861"></A><CODE CLASS="Code">
:jpg</CODE>
</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1540583"></A>&quot;JPEG&quot;</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1527865"></A><CODE CLASS="Code">
:jpg</CODE>
</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1540713"></A>&quot;JFIF&quot;</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1527869"></A><CODE CLASS="Code">
:jpg</CODE>
</P>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1540719"></A>&quot;JP2&quot;</P>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<P CLASS="CellBody">
<A NAME="pgfId-1527873"></A><CODE CLASS="Code">
:jpg2000</CODE>
</P>
</TD>
</TR>
</TABLE>
<P CLASS="RBody">
<A NAME="pgfId-1525886"></A><B CLASS="Bold">
Note:</B>
 Image type <CODE CLASS="Code">
:jpg2000</CODE>
 is implemented on Cocoa only.</P>
<P CLASS="RBody">
<A NAME="pgfId-1525887"></A><EM CLASS="Variable">
errorp</EM>
 controls what happens if <CODE CLASS="Code">
externalize-and-write-image</CODE>
 does not recognize the type. If <EM CLASS="Variable">
errorp</EM>
 is non-nil, it calls <CODE CLASS="Code">
error</CODE>
, otherwise it returns <CODE CLASS="Code">
nil</CODE>
. The default value of <EM CLASS="Variable">
errorp</EM>
 is <CODE CLASS="Code">
t</CODE>
.</P>
<P CLASS="RBody">
<A NAME="pgfId-1525888"></A><EM CLASS="Variable">
if-exists</EM>
 controls what to do if the filename already exists, in the same way as the <EM CLASS="Variable">
if-exists</EM>
 argument to <CODE CLASS="Code">
open</CODE>
. However, unlike <CODE CLASS="Code">
open</CODE>
, the default value of <EM CLASS="Variable">
if-exists</EM>
 is <CODE CLASS="Code">
:supersede</CODE>
. </P>
<P CLASS="RBody">
<A NAME="pgfId-1525889"></A><EM CLASS="Variable">
x-hot</EM>
 and <EM CLASS="Variable">
y-hot</EM>
 are used only when generating a CUR file, which is currently implemented on GTK+ only. They specify the hotspot coordinates when the image is used as a cursor (in a LispWorks application by <A HREF="capiref-223.htm#28057" CLASS="XRef">load-cursor</A> and <CODE CLASS="Code">
(setf capi:simple-pane-cursor)</CODE>
, or in other applications). Their values must be integers within the width/height of the image. The default value of both <EM CLASS="Variable">
x-hot</EM>
 and <EM CLASS="Variable">
y-hot</EM>
 is 0.</P>
<P CLASS="RBody">
<A NAME="pgfId-1525890"></A><EM CLASS="Variable">
quality</EM>
 is used for writing a JPG image on GTK+. It must be an integer in the inclusive range [0,100]. High values generate better images and larger files. </P>
<P CLASS="RBody">
<A NAME="pgfId-1525891"></A><EM CLASS="Variable">
result</EM>
 is <EM CLASS="Variable">
filename</EM>
 on success, or <CODE CLASS="Code">
nil</CODE>
 for an unknown type when <EM CLASS="Variable">
errorp</EM>
 is <CODE CLASS="Code">
nil</CODE>
. It signals an error in other cases (for example, failure to open the file because of permissions). </P>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525892"></A>Examples</H5>
<P CLASS="RBody">
<A NAME="pgfId-1525893"></A>There is a simple example in:</P>
<CODE CLASS="RCode-line">
<A NAME="pgfId-1525894"></A>examples/capi/graphics/images-with-alpha.lisp</CODE>
</DIV>
<DIV>
<H5 CLASS="REntry-head">
<A NAME="pgfId-1525895"></A>See also</H5>
<P CLASS="RBody">
<A NAME="pgfId-1525896"></A><A HREF="capiref-590.htm#50874" CLASS="XRef">list-known-image-formats</A></P>
</DIV>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI Reference Manual - 15 Dec 2011</I></P>
<P><A HREF="capiref-541.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiref-539.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiref-495.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiref.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiref-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiref-693.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
