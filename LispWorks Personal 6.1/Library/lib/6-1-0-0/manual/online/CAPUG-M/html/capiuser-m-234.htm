<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 6.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="capiuser-m.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE>
 15.7.1  Establishing a page transform
</TITLE>

<LINK REL="next" HREF="capiuser-m-235.htm" TYPE="text/html">
<LINK REL="prev" HREF="capiuser-m-233.htm" TYPE="text/html">
<LINK REL="up" HREF="capiuser-m-233.htm" TYPE="text/html">
<LINK REL="top" HREF="capiuser-m.htm" TYPE="text/html">
<LINK REL="contents" HREF="capiuser-m-2.htm" TYPE="text/html">
<LINK REL="index" HREF="capiuser-m-252.htm" TYPE="text/html">
</HEAD>
<BODY BGCOLOR="#ffffff">
<DIV CLASS="HTMLBreadCrumbs"><A HREF="../../intro.htm">All Manuals</A> &gt <A HREF="capiuser-m.htm">CAPI User Guide</A> &gt <A HREF="capiuser-m-225.htm">15 Printing from the CAPI--the Hardcopy API</A> &gt <A HREF="capiuser-m-233.htm">15.7  Printing a page</A><BR><BR>
</DIV><A HREF="capiuser-m-235.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiuser-m-233.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiuser-m-233.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiuser-m.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiuser-m-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiuser-m-252.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
<H3 CLASS="FM2Heading">
<A NAME="pgfId-903490"></A>15.7.1  Establishing a page transform</H3>
<P CLASS="Body">
<A NAME="pgfId-903491"></A>The <A NAME="marker-904672"></A><CODE CLASS="Code">
with-page-transform</CODE>
 macro can be used to establish a page transform which controls scaling by mapping a rectangular region of the document to the printable area of the page. The scale matches the screen by default. By specifying a large rectangle, you can get finer granularity in the drawing. Any number of invocations of <CODE CLASS="Code">
with-page-transform</CODE>
 may occur during the printing of a page. For instance, it may be convenient to use a different page transform when printing headers and footers to the page from that used when printing the main body of the page.</P>
<P CLASS="Body">
<A NAME="pgfId-903492"></A>A helper function, <A NAME="marker-904680"></A><CODE CLASS="Code">
get-page-area</CODE>
, is provided to simplify the calculation of suitable rectangles for use with <CODE CLASS="Code">
with-page-transform</CODE>
. It calculates the width and height of the rectangle in the user's coordinate space that correspond to one printable page, based on the logical resolution of the user's coordinate space in dpi.</P>
<P CLASS="Body">
<A NAME="pgfId-903493"></A>For more specific control over the page transform, the printer metrics can be queried using <A NAME="marker-904685"></A><CODE CLASS="Code">
get-printer-metrics</CODE>
 and the various printer-metrics accessors such as <CODE CLASS="Code">
printer-metrics-height</CODE>
. </P>
<P CLASS="Body">
<A NAME="pgfId-903572"></A>Margins and the printable area can be set using <CODE CLASS="Code">
</CODE>
 <A NAME="marker-904690"></A><CODE CLASS="Code">
set-printer-metrics</CODE>
.</P>
<P CLASS="Body">
<A NAME="pgfId-905112"></A>There is an example in <CODE CLASS="Code">
examples/capi/printing/fit-to-page.lisp</CODE>
.</P>
<HR>
<P CLASS="Copyrighttext-small"><I CLASS="Italic">CAPI User Guide (Macintosh version) - 30 Aug 2011</I></P>
<P><A HREF="capiuser-m-235.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A><A HREF="capiuser-m-233.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Prev BORDER=0></A><A HREF="capiuser-m-233.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A><A HREF="capiuser-m.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A><A HREF="capiuser-m-2.htm"><IMG ALIGN=BOTTOM SRC=contents.gif ALT=Contents BORDER=0></A><A HREF="capiuser-m-252.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A>
</BODY>
</HTML>
